(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    258993,       6947]
NotebookOptionsPosition[    250847,       6742]
NotebookOutlinePosition[    251234,       6759]
CellTagsIndexPosition[    251191,       6756]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Tight Binding Model for Studying the Effect of Spin-Orbit Coupling in \
Multi-layers in the Frame of Linear Response theory\
\>", "Title",
 CellChangeTimes->{{3.732768894172805*^9, 
  3.7327690104747677`*^9}},ExpressionUUID->"9af2dee5-d204-4922-9712-\
36c794d0b96b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<GreenSlab`\>\"", "]"}], ";"}]], "Input",Expressio\
nUUID->"5b8d71db-a909-4b56-8c7d-611e20f79511"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\\t\\tWelcome to \
\\!\\(\\*\\nStyleBox[\\\"GreenSlab\\\",\\nFontWeight->\\\"Bold\\\"]\\).\\n\\t\
\\t\"\>", "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {
       StyleBox["\<\"G\"\>",
        StripOnInput->False,
        LineColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]],
        FrontFaceColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]],
        BackFaceColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]],
        GraphicsColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]],
        FontWeight->Bold,
        FontColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]]], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 1, 1], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.6666666666666666, 0.6666666666666666],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 1, 1]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 1, 1]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 1, 1],
        Editable->False,
        Selectable->False], "0", "0", "0", "0", "0", "0", "0"},
      {
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 1, 1], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.6666666666666666, 0.6666666666666666],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 1, 1]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 1, 1]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 1, 1],
        Editable->False,
        Selectable->False], 
       StyleBox["\<\"R\"\>",
        StripOnInput->False,
        LineColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]],
        FrontFaceColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]],
        BackFaceColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]],
        GraphicsColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]],
        FontWeight->Bold,
        FontColor->RGBColor[
          Rational[1, 2], 0, 
          Rational[1, 2]]], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 
              Rational[1, 2], 
              Rational[1, 2]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0.6666666666666666, 0.3333333333333333, 0.3333333333333333],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 1/2, 1/2]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 
               Rational[1, 2], 
               Rational[1, 2]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 
         Rational[1, 2], 
         Rational[1, 2]],
        Editable->False,
        Selectable->False], "0", "0", "0", "0", "0", "0"},
      {"0", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 
              Rational[1, 2], 
              Rational[1, 2]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           
           FrameStyle->RGBColor[
            0.6666666666666666, 0.3333333333333333, 0.3333333333333333],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 1/2, 1/2]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 
               Rational[1, 2], 
               Rational[1, 2]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 
         Rational[1, 2], 
         Rational[1, 2]],
        Editable->False,
        Selectable->False], 
       StyleBox["\<\"E\"\>",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 1],
        FrontFaceColor->RGBColor[1, 0, 1],
        BackFaceColor->RGBColor[1, 0, 1],
        GraphicsColor->RGBColor[1, 0, 1],
        FontWeight->Bold,
        FontColor->RGBColor[1, 0, 1]], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 1, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.6666666666666666, 0.],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 1, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 1, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 1, 0],
        Editable->False,
        Selectable->False], "0", "0", "0", "0", "0"},
      {"0", "0", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 1, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.6666666666666666, 0.],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 1, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 1, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 1, 0],
        Editable->False,
        Selectable->False], 
       StyleBox["\<\"E\"\>",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 1],
        FrontFaceColor->RGBColor[1, 0, 1],
        BackFaceColor->RGBColor[1, 0, 1],
        GraphicsColor->RGBColor[1, 0, 1],
        FontWeight->Bold,
        FontColor->RGBColor[1, 0, 1]], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 1, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.6666666666666666, 0.],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 1, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 1, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 1, 0],
        Editable->False,
        Selectable->False], "0", "0", "0", "0"},
      {"0", "0", "0", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 1, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.6666666666666666, 0.],
           FrameTicks->None,
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 1, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 1, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 1, 0],
        Editable->False,
        Selectable->False], 
       StyleBox["\<\"N\"\>",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 1],
        FrontFaceColor->RGBColor[1, 0, 1],
        BackFaceColor->RGBColor[1, 0, 1],
        GraphicsColor->RGBColor[1, 0, 1],
        FontWeight->Bold,
        FontColor->RGBColor[1, 0, 1]], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 
              Rational[2, 3], 
              Rational[2, 3]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.4444444444444444, 0.4444444444444444],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 2/3, 2/3]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 
               Rational[2, 3], 
               Rational[2, 3]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 
         Rational[2, 3], 
         Rational[2, 3]],
        Editable->False,
        Selectable->False], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 
              Rational[2, 3], 
              Rational[2, 3]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.4444444444444444, 0.4444444444444444],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 2/3, 2/3]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 
               Rational[2, 3], 
               Rational[2, 3]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 
         Rational[2, 3], 
         Rational[2, 3]],
        Editable->False,
        Selectable->False], "0", "0"},
      {"0", "0", "0", "0", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 
              Rational[2, 3], 
              Rational[2, 3]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.4444444444444444, 0.4444444444444444],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 2/3, 2/3]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 
               Rational[2, 3], 
               Rational[2, 3]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 
         Rational[2, 3], 
         Rational[2, 3]],
        Editable->False,
        Selectable->False], 
       StyleBox["\<\"S\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontWeight->Bold,
        FontColor->RGBColor[0, 0, 1]], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0., 0.6666666666666666],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 0, 1]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 0, 1]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 0, 1],
        Editable->False,
        Selectable->False], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.5, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.5, 0],
        Editable->False,
        Selectable->False], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.5, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.5, 0],
        Editable->False,
        Selectable->False]},
      {"0", "0", "0", "0", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 
              Rational[2, 3], 
              Rational[2, 3]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0.4444444444444444, 0.4444444444444444],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 2/3, 2/3]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 
               Rational[2, 3], 
               Rational[2, 3]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 
         Rational[2, 3], 
         Rational[2, 3]],
        Editable->False,
        Selectable->False], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0., 0.6666666666666666],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 0, 1]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 0, 1]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 0, 1],
        Editable->False,
        Selectable->False], 
       StyleBox["\<\"L\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontWeight->Bold,
        FontColor->RGBColor[0, 0, 1]], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.5, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.5, 0],
        Editable->False,
        Selectable->False], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.5, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.5, 0],
        Editable->False,
        Selectable->False]},
      {"0", "0", "0", "0", "0", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.5, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.5, 0],
        Editable->False,
        Selectable->False], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.5, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.5, 0],
        Editable->False,
        Selectable->False], 
       StyleBox["\<\"A\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontWeight->Bold,
        FontColor->RGBColor[0, 0, 1]], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0., 0.6666666666666666],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 0, 1]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 0, 1]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 0, 1],
        Editable->False,
        Selectable->False]},
      {"0", "0", "0", "0", "0", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
           
           FrameTicks->None,
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.5, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.5, 0],
        Editable->False,
        Selectable->False], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[1, 0.5, 0], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0.6666666666666666, 0.33333333333333337`, 0.],
           
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[1, 0.5, 0]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[1, 0.5, 0]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[1, 0.5, 0],
        Editable->False,
        Selectable->False], 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[0, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           Frame->True,
           FrameStyle->RGBColor[0., 0., 0.6666666666666666],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          "RGBColor[0, 0, 1]"],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[0, 0, 1]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[0, 0, 1],
        Editable->False,
        Selectable->False], 
       StyleBox["\<\"B\"\>",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontWeight->Bold,
        FontColor->RGBColor[0, 0, 1]]}
     },
     AutoDelete->False,
     GridBoxDividers->{"ColumnsIndexed" -> {3 -> RGBColor[1, 
           Rational[1, 2], 
           Rational[1, 2]], 6 -> RGBColor[1, 0, 0]}, 
       "RowsIndexed" -> {3 -> RGBColor[1, 
           Rational[1, 2], 
           Rational[1, 2]], 6 -> RGBColor[1, 0, 0]}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}],
  SequenceForm[
  "\t\tWelcome to \!\(\*\nStyleBox[\"GreenSlab\",\nFontWeight->\"Bold\"]\).\n\
\t\t", 
   Grid[{{
      Style["G", Bold, 
       RGBColor[
        Rational[1, 2], 0, 
        Rational[1, 2]]], 
      RGBColor[0, 1, 1], 0, 0, 0, 0, 0, 0, 0}, {
      RGBColor[0, 1, 1], 
      Style["R", Bold, 
       RGBColor[
        Rational[1, 2], 0, 
        Rational[1, 2]]], 
      RGBColor[1, 
       Rational[1, 2], 
       Rational[1, 2]], 0, 0, 0, 0, 0, 0}, {0, 
      RGBColor[1, 
       Rational[1, 2], 
       Rational[1, 2]], 
      Style["E", Bold, 
       RGBColor[1, 0, 1]], 
      RGBColor[0, 1, 0], 0, 0, 0, 0, 0}, {0, 0, 
      RGBColor[0, 1, 0], 
      Style["E", Bold, 
       RGBColor[1, 0, 1]], 
      RGBColor[0, 1, 0], 0, 0, 0, 0}, {0, 0, 0, 
      RGBColor[0, 1, 0], 
      Style["N", Bold, 
       RGBColor[1, 0, 1]], 
      RGBColor[0, 
       Rational[2, 3], 
       Rational[2, 3]], 
      RGBColor[0, 
       Rational[2, 3], 
       Rational[2, 3]], 0, 0}, {0, 0, 0, 0, 
      RGBColor[0, 
       Rational[2, 3], 
       Rational[2, 3]], 
      Style["S", Bold, 
       RGBColor[0, 0, 1]], 
      RGBColor[0, 0, 1], 
      RGBColor[1, 0.5, 0], 
      RGBColor[1, 0.5, 0]}, {0, 0, 0, 0, 
      RGBColor[0, 
       Rational[2, 3], 
       Rational[2, 3]], 
      RGBColor[0, 0, 1], 
      Style["L", Bold, 
       RGBColor[0, 0, 1]], 
      RGBColor[1, 0.5, 0], 
      RGBColor[1, 0.5, 0]}, {0, 0, 0, 0, 0, 
      RGBColor[1, 0.5, 0], 
      RGBColor[1, 0.5, 0], 
      Style["A", Bold, 
       RGBColor[0, 0, 1]], 
      RGBColor[0, 0, 1]}, {0, 0, 0, 0, 0, 
      RGBColor[1, 0.5, 0], 
      RGBColor[1, 0.5, 0], 
      RGBColor[0, 0, 1], 
      Style["B", Bold, 
       RGBColor[0, 0, 1]]}}, Dividers -> {{3 -> RGBColor[1, 
         Rational[1, 2], 
         Rational[1, 2]], 6 -> RGBColor[1, 0, 0]}, {3 -> RGBColor[1, 
         Rational[1, 2], 
         Rational[1, 2]], 6 -> RGBColor[1, 0, 0]}}, 
    ItemSize -> {Automatic, Automatic}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.738482826175119*^9, 3.738994728175171*^9, 
  3.738994826066924*^9, 3.738995089290917*^9, 3.738995290649866*^9, 
  3.7389954595154667`*^9},ExpressionUUID->"26a3a53b-9633-449a-936c-\
f47e193be4a7"],

Cell[BoxData["\<\"\\nThe package will help you to build a slab \
Hamiltonian\\nfor a given number of layers.\\nYou can construct the retarded \
or advanced Greens function\\nand use it in Linear Response Theory.\\nIt can \
also calculate normal band structure and band structure with \\na weight \
corresponding to an operator.\"\>"], "Print",
 CellChangeTimes->{3.738482826175119*^9, 3.738994728175171*^9, 
  3.738994826066924*^9, 3.738995089290917*^9, 3.738995290649866*^9, 
  3.7389954595345078`*^9},ExpressionUUID->"8419d838-6340-485c-b121-\
0ae94abe967a"],

Cell[BoxData["\<\"\\nWhile calling the the inbuilt functions use them in a \
definition rather than\\nin a function. For example use\\n\\t\\t \
f[kx_]=Combine[Cos[kx],-Cos[kx],1]\\n\\!\\(\\*StyleBox[\\\"not\\\",\\\
nFontWeight->\\\"Bold\\\"]\\)\\t  f[kx_]:=Combine[Cos[kx],-Cos[kx],1]\\n\\nGr \
and Ga involves Inverse. For large Hamiltonians (n>4) either use Gr,Ga in \
functions\\nfor example \\t\\t a[x_]:=Gr[H[x]]-Ga[H[x]]\\nor use a numerical \
matrix for H.\"\>"], "Print",
 CellChangeTimes->{3.738482826175119*^9, 3.738994728175171*^9, 
  3.738994826066924*^9, 3.738995089290917*^9, 3.738995290649866*^9, 
  3.738995459535569*^9},ExpressionUUID->"48560553-b44c-411c-a7da-\
ec6bcb7fd268"],

Cell[BoxData["\<\"\\nType Info[GreenSlab] to see all available functions and \
info[function_name]\\nto get information about a particular \
function.\\n\\nSumit Ghosh 13-06-2018 V1.0 (sumit.ghosh@kaust.edu.sa)\"\>"], \
"Print",
 CellChangeTimes->{3.738482826175119*^9, 3.738994728175171*^9, 
  3.738994826066924*^9, 3.738995089290917*^9, 3.738995290649866*^9, 
  3.738995459536892*^9},ExpressionUUID->"fa8e37ca-da4c-459d-b471-\
9a3e9058131f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters", "Section",
 CellChangeTimes->{{3.732351756222397*^9, 
  3.732351758414318*^9}},ExpressionUUID->"e4b942c9-2943-4194-b791-\
0a9d34585dd2"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "VsF", ",", "VdF", ",", "VpF", ",", "VsN", ",", "VdN", ",", "VpN", ",", 
   "VsFN", ",", "VdFN", ",", "VpFN", ",", "a0", ",", "ExyF", ",", "ExzF", ",",
    "EyzF", ",", "ExyN", ",", "ExzN", ",", "EyzN", ",", "JxyF", ",", "JxzF", 
   ",", "JyzF", ",", "V0n", ",", "Vn", ",", "Vf", ",", "J", ",", "xi", ",", 
   "eta", ",", "th", ",", "fi", ",", "G", ",", "hbar", ",", "ehbar", ",", "n",
    ",", "Nn", ",", "Ef", ",", "L", ",", "ch"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbF", " ", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nbN", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ch", "[", "i_", "]"}], ":=", "xi"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Slater", "-", 
     RowBox[{"Koster", " ", "2"}], "-", 
     RowBox[{"center", " ", "parameters"}]}], ",", "  ", "Orthogonal", ",", 
    " ", 
    RowBox[{
    "1", "rst", " ", "neighbor", " ", "and", " ", "2", "nd", " ", "neighbor", 
     " ", "Handbook", " ", "of", " ", "the", " ", "Band", " ", "Structure", 
     " ", "of", " ", "Elemental", " ", "Solids"}], ",", " ", 
    RowBox[{
    "we", " ", "use", " ", "iron", " ", "and", " ", "tungsten", " ", "as", 
     " ", "they", " ", "are", " ", "bcc"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "maybe", " ", "not", " ", "useful", " ", "as", " ", "we", " ", "implement",
     " ", "magnetization", " ", "by", " ", "hand"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VsF1up", "=", " ", 
     RowBox[{
      RowBox[{"-", "0.04541"}], "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"-", "0.0388"}], "*", "13.6", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VpF1up", "=", " ", 
     RowBox[{"0.02714", "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{"0.02387", "*", "13.6", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VdF1up", "=", " ", 
     RowBox[{
      RowBox[{"-", "0.00260"}], "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"-", "0.00384"}], "*", "13.6", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VsF1down", "=", " ", 
     RowBox[{
      RowBox[{"-", "0.05266"}], "*", "13.6"}]}], " ", ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"-", "0.04403"}], "*", "13.6", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VpF1down", "=", "  ", 
     RowBox[{"0.03276", "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{"0.02763", "*", "13.6", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VdF1down", "=", 
     RowBox[{
      RowBox[{"-", "0.00286"}], "*", "13.6"}]}], " ", ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"-", "0.00442"}], "*", "13.6", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"VsF2up", "=", 
     RowBox[{
      RowBox[{"-", "0.02713"}], "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"-", "0.00669"}], "*", "13.6", " ", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VpF2up", "=", 
     RowBox[{"0.00589", "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{"0.00167", "*", "13.6", " ", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VdF2up", "=", 
     RowBox[{"0.00060", "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{"0.00023", "*", "13.6", " ", "Co", " ", "up"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VsF2down", "=", 
     RowBox[{
      RowBox[{"-", "0.03396"}], "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"-", "0.00793"}], "*", "13.6", " ", "Co", " ", "down"}], "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{"VpF2down", "=", 
     RowBox[{"0.00581", "*", "13.6"}]}], ";", 
    RowBox[{"(*", "Fe", "*)"}], " ", 
    RowBox[{"(*", 
     RowBox[{"0.00198", "*", "13.6", " ", "Co", " ", "down"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"VdF2down", "=", 
     RowBox[{"0.00114", "*", "13.6"}]}], ";"}], 
   RowBox[{"(*", "Fe", "*)"}], " ", 
   RowBox[{"(*", 
    RowBox[{"0.00026", "*", "13.6", " ", "Co", " ", "down"}], "*)"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"here", " ", "we", " ", "write", " ", "our", " ", "parameters"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VsF1", "=", " ", 
    RowBox[{
     RowBox[{"-", "0.04541"}], "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "Fe", "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"-", "0.0388"}], "*", "13.6", "Co", " ", "up"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VpF1", "=", " ", 
    RowBox[{"0.02714", "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "Fe", "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{"0.02387", "*", "13.6", "Co", " ", "up"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VdF1", "=", " ", 
    RowBox[{
     RowBox[{"-", "0.00260"}], "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "Fe", "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"-", "0.00384"}], "*", "13.6", "Co", " ", "up"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VsF2", "=", 
    RowBox[{
     RowBox[{"-", "0.02713"}], "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "Fe", "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"-", "0.00669"}], "*", "13.6", " ", "Co", " ", "up"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VpF2", "=", 
    RowBox[{"0.00589", "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "Fe", "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{"0.00167", "*", "13.6", " ", "Co", " ", "up"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VdF2", "=", 
    RowBox[{"0.00060", "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "Fe", "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{"0.00023", "*", "13.6", " ", "Co", " ", "up"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VsN1", "=", " ", 
    RowBox[{
     RowBox[{"-", "0.11837"}], "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "W", "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"-", "0.06856"}], "*", "13.6", " ", "Pt", " ", "fcc"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VpN1", "=", " ", 
    RowBox[{"0.05194", "*", "13.6"}]}], ";"}], " ", 
  RowBox[{"(*", "W", "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"0.03528", "*", "13.6", " ", "Pt", " ", "fcc"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VdN1", "=", " ", 
    RowBox[{"0.00248", "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "W", "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"-", "0.00588"}], "*", "13.6", " ", "Pt", " ", "fcc"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VsN2", "=", " ", 
    RowBox[{
     RowBox[{"-", "0.07313"}], "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "W", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VpN2", "=", " ", 
    RowBox[{
     RowBox[{"-", "0.01264"}], "*", "13.6"}]}], ";"}], " ", 
  RowBox[{"(*", "W", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VdN2", "=", " ", 
    RowBox[{"0.00908", "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", "W", "*)"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VsFN1", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"0.04541", "+", "0.11837"}], ")"}]}], "*", 
     RowBox[{"13.6", "/", "2"}]}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VpFN1", "=", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{"0.02714", "+", "0.05194"}], ")"}], "*", 
    RowBox[{"13.6", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VdFN1", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.00260"}], "+", "0.00248"}], ")"}], "*", 
     RowBox[{"13.6", "/", "2"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VsFN2", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"0.02713", "+", "0.07313"}], ")"}]}], "*", 
     RowBox[{"13.6", "/", "2"}]}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VpFN2", "=", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{"0.00589", " ", "-", "0.01264"}], ")"}], "*", 
    RowBox[{"13.6", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VdFN2", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.00060", "+", "0.00908"}], ")"}], "*", 
     RowBox[{"13.6", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"-", "13.6"}], " ", "eV", " ", "is", " ", "the", " ", "binding", 
    " ", "Energy", " ", "of", " ", "the", " ", "elecron", " ", "of", " ", 
    "the", " ", "Hydrogen", " ", "atom"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a0", "=", 
    RowBox[{"0.316", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "9"}]}]}]}], ";"}], 
  RowBox[{"(*", "m", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExyF", "=", 
    RowBox[{"E0", "+", "t2gF"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"t2gFUp", "=", 
     RowBox[{"0.64840", "*", "13.6"}]}], ",", 
    RowBox[{"t2gFDn", "=", 
     RowBox[{"0.78456", "*", "13.6"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExzF", "=", 
    RowBox[{"E0", "+", "t2gF"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"t2gFUp", "=", 
     RowBox[{"0.64840", "*", "13.6"}]}], ",", 
    RowBox[{"t2gFDn", "=", 
     RowBox[{"0.78456", "*", "13.6"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EyzF", "=", 
    RowBox[{"E0", "+", "t2gF"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"t2gFUp", "=", 
     RowBox[{"0.64840", "*", "13.6"}]}], ",", 
    RowBox[{"t2gFDn", "=", 
     RowBox[{"0.78456", "*", "13.6"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ex2y2F", "=", 
    RowBox[{"E0", "+", "egF"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"egFUp", "=", 
     RowBox[{"0.62960", "*", "13.6"}]}], ",", " ", 
    RowBox[{"egFDn", "=", 
     RowBox[{"0.75661", "*", "13.6"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ez2F", "=", 
    RowBox[{"E0", "+", "egF"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"egFUp", "=", 
     RowBox[{"0.62960", "*", "13.6"}]}], ",", " ", 
    RowBox[{"egFDn", "=", 
     RowBox[{"0.75661", "*", "13.6"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExyN", "=", "t2gN"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"t2gN", "=", 
    RowBox[{"0.96813", "*", "13.6"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExzN", "=", "t2gN"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"t2gN", "=", 
    RowBox[{"0.96813", "*", "13.6"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EyzN", "=", "t2gN"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"t2gN", "=", 
    RowBox[{"0.96813", "*", "13.6"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ex2y2N", "=", "egN"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"egN", "=", 
    RowBox[{"0.85720", "*", "13.6"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ez2N", "=", "egN"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"egN", "=", 
    RowBox[{"0.85720", "*", "13.6"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JxyF", "=", "Jt2g"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JxzF", "=", "Jt2g"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JyzF", "=", "Jt2g"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jx2y2F", "=", "Jeg"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jz2F", "=", "Jeg"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2gN", "=", 
   RowBox[{"0.96813", "*", "13.6"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"egN", "=", 
   RowBox[{"0.85720", "*", "13.6"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E0", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2gF", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0.64840", "*", "13.6"}], "+", 
      RowBox[{"0.78456", "*", "13.6"}]}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"egF", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0.62960", "*", "13.6"}], "+", 
      RowBox[{"0.75661", "*", "13.6"}]}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jt2g", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"0.64840", "*", "13.6"}], "-", 
     RowBox[{"0.78456", "*", "13.6"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Jeg", "=", "Jt2g"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Jeg", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.62960", "*", "13.6"}], "-", 
       RowBox[{"0.75661", "*", "13.6"}]}], ")"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xi", "=", 
    RowBox[{"0.014", "*", "13.6"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"0.36", " ", "W"}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{"0.4", " ", "Pt"}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"0.065", " ", "Co"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{
   "in", " ", "Solid", " ", "State", " ", "Physics", " ", "by", " ", 
    "Aurelien"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eta", "=", 
   RowBox[{"Pi", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"th", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fi", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hbar", "=", 
    RowBox[{"6.58", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "16"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"eV", ".", "s"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ehbar", "=", 
   RowBox[{"6.58", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "16"}]}], "*", "1.6", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "19"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ef", "=", "10.0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"eV", " ", "/", "real"}], " ", "Fermi", " ", "energy", " ", "of", 
    " ", 
    RowBox[{"Tungsten", ":", " ", 
     RowBox[{"11", "eV"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"muB", "=", 
    RowBox[{"5.788", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "5"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"eV", "/", "Oe"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vmag", "=", 
    RowBox[{"muB", "*", 
     RowBox[{"ee", "/", 
      RowBox[{"(", 
       RowBox[{"Ms", "*", "L", "*", "a0"}], ")"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"m", "^", "2"}], " ", "-", " ", 
    RowBox[{"see", " ", "below"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ee", "=", 
   RowBox[{"1.6", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "19"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ms", "=", 
    RowBox[{"800", "*", 
     RowBox[{"10", "^", "3"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"A", "/", "m"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "100"}], ";"}]}], "Input",
 CellChangeTimes->{{3.718456139123888*^9, 3.718456262173263*^9}, {
   3.718959875599193*^9, 3.7189598857004557`*^9}, {3.720236832351997*^9, 
   3.720236836781786*^9}, {3.7202666680052633`*^9, 3.720266668299755*^9}, {
   3.7323521259554367`*^9, 3.732352127396076*^9}, {3.732353323945244*^9, 
   3.732353328096937*^9}, {3.73340020342492*^9, 3.733400238807621*^9}, {
   3.733400280223913*^9, 3.733400293895472*^9}, {3.733400331194126*^9, 
   3.7334003516323643`*^9}, {3.7334004021052*^9, 3.733400402897051*^9}, {
   3.733400441129387*^9, 3.733400463969157*^9}, {3.7334010491782303`*^9, 
   3.733401049848255*^9}, {3.7334532892335176`*^9, 3.733453298181878*^9}, {
   3.7334533734303226`*^9, 3.733453399007209*^9}, {3.733454051714163*^9, 
   3.7334540587507057`*^9}, {3.734258741994182*^9, 3.734258770609221*^9}, {
   3.734745714718364*^9, 3.734745716771798*^9}, {3.734773896606163*^9, 
   3.734773896992586*^9}, {3.734849224334189*^9, 3.734849265084478*^9}, {
   3.7348493100854063`*^9, 3.734849310321624*^9}, {3.734853445560588*^9, 
   3.73485344634909*^9}, {3.7348539043917418`*^9, 3.734853921549653*^9}, {
   3.734854227775069*^9, 3.7348542279184027`*^9}, {3.734856966378673*^9, 
   3.734856970875342*^9}, {3.734932186962677*^9, 3.734932196927547*^9}, {
   3.734935073517392*^9, 3.7349351559515543`*^9}, {3.73493992863237*^9, 
   3.7349399878946657`*^9}, {3.735185490828147*^9, 3.735185494572452*^9}, {
   3.735558157486384*^9, 3.735558169067152*^9}, 3.735558642489311*^9, {
   3.735874718771639*^9, 3.735874719613329*^9}, {3.735876155056288*^9, 
   3.7358763305615788`*^9}, {3.735876417194355*^9, 3.735876494710451*^9}, {
   3.735876535274559*^9, 3.735876535959922*^9}, {3.735876627631476*^9, 
   3.735876632520195*^9}, {3.7358767045941057`*^9, 3.735876728687772*^9}, 
   3.735876822427253*^9, {3.7358768556563187`*^9, 3.7358768658346157`*^9}, {
   3.735877676144642*^9, 3.7358777665477877`*^9}, {3.735877799143701*^9, 
   3.735877810763526*^9}, {3.7358778424760113`*^9, 3.735877846299395*^9}, {
   3.7358778872659683`*^9, 3.735877933181602*^9}, {3.73588093036789*^9, 
   3.735880964951354*^9}, {3.7358813115717173`*^9, 3.735881338449236*^9}, {
   3.735881896652392*^9, 3.735881915730154*^9}, {3.735882051243754*^9, 
   3.735882056016244*^9}, {3.7363937313267517`*^9, 3.736393743749092*^9}, {
   3.736396434329273*^9, 3.7363964368482103`*^9}, {3.736404764354292*^9, 
   3.736404775764345*^9}, {3.736755449314789*^9, 3.73675546689437*^9}, {
   3.736755539953377*^9, 3.736755547002306*^9}, {3.736755577650305*^9, 
   3.7367556792669907`*^9}, {3.736757003429852*^9, 3.736757042917589*^9}, {
   3.7367571156287193`*^9, 3.73675712987352*^9}, {3.7367575931209307`*^9, 
   3.736757679445528*^9}, {3.736757757784133*^9, 3.7367577880052834`*^9}, {
   3.736757818857923*^9, 3.7367579454251833`*^9}, {3.736757997785336*^9, 
   3.736758018320239*^9}, {3.736758057219303*^9, 3.73675815454156*^9}, {
   3.7367586125045843`*^9, 3.736758912291745*^9}, {3.736758988170566*^9, 
   3.7367590898705683`*^9}, {3.736759125108077*^9, 3.736759164125495*^9}, {
   3.737009012588007*^9, 3.7370090205683527`*^9}, 3.73700917786242*^9, {
   3.737028619009645*^9, 3.7370286384359426`*^9}, {3.737028730443239*^9, 
   3.7370287305577497`*^9}, 3.73702879355737*^9, {3.7370290766710987`*^9, 
   3.7370290776403847`*^9}, {3.737029489845785*^9, 3.737029489954843*^9}, {
   3.737081773007032*^9, 3.737081779373538*^9}, 3.737081871233305*^9, 
   3.737082012926396*^9, {3.737082482693585*^9, 3.737082488520876*^9}, {
   3.7370825604810867`*^9, 3.737082640719449*^9}, {3.737087025490127*^9, 
   3.737087025601122*^9}, {3.7370872015209923`*^9, 3.737087201818861*^9}, 
   3.7372825623783216`*^9, {3.7372826942428913`*^9, 3.73728278321714*^9}, 
   3.737287717784048*^9, 3.7372903140760803`*^9, {3.737691543955298*^9, 
   3.737691560047361*^9}, {3.7376959326678553`*^9, 3.7376959506441507`*^9}, 
   3.737696215686143*^9, 3.737707971595215*^9, {3.737708089754325*^9, 
   3.737708090685936*^9}, 3.737709458368744*^9, {3.7377097269038754`*^9, 
   3.737709750850093*^9}, {3.737712564102325*^9, 3.737712566900256*^9}, 
   3.737713116073927*^9, 3.7377744163447447`*^9, 3.737786738388235*^9, {
   3.737786878852173*^9, 3.737786878986709*^9}, 3.7377911017061367`*^9, 
   3.7377914331896267`*^9, {3.737791471186363*^9, 3.737791471338306*^9}, {
   3.737794036547242*^9, 3.737794044090337*^9}, 3.737794080538312*^9, {
   3.73779419400555*^9, 3.737794194164907*^9}, {3.737795473629554*^9, 
   3.737795481486418*^9}, {3.737796682641292*^9, 3.7377966845059566`*^9}, {
   3.737796748258308*^9, 3.737796749717445*^9}, {3.737796801056492*^9, 
   3.737796802337925*^9}, {3.737796888269764*^9, 3.737796890590884*^9}, {
   3.737797000447497*^9, 3.73779700269591*^9}, {3.7378874736338263`*^9, 
   3.737887474992584*^9}, 3.737957303112507*^9, {3.737963435570757*^9, 
   3.7379634449680443`*^9}, {3.737964088847373*^9, 3.737964092667837*^9}, {
   3.73797051890765*^9, 3.737970529351433*^9}, {3.737971279346776*^9, 
   3.7379712817655697`*^9}, 3.7379716736731586`*^9, 3.737972485549049*^9, 
   3.737972756028009*^9, {3.737972801755692*^9, 3.737972802429202*^9}, 
   3.737972958324822*^9, {3.738206006660075*^9, 3.738206011834024*^9}, {
   3.7382065405488462`*^9, 3.738206542454505*^9}, {3.7382073241886883`*^9, 
   3.738207342297762*^9}, {3.738213345184329*^9, 3.73821334867701*^9}, 
   3.738223256144209*^9, {3.738470389349855*^9, 3.738470390086316*^9}, {
   3.7384704212658167`*^9, 3.738470459823127*^9}, 3.738470982971404*^9, 
   3.738474213361643*^9, {3.7384813873946667`*^9, 3.738481387668404*^9}, {
   3.738995058092504*^9, 3.738995058354415*^9}, {3.7389954429817467`*^9, 
   3.738995443104924*^9}},ExpressionUUID->"a64f41bf-45e3-4440-9d11-\
f7dbd4a98788"],

Cell["\<\
Some standard values: Ef=1.5, V0=-1, J=1; then play around; typical effective \
magnetic volume is \\muB/(Msd)=1.157x10^-20 m^2, with Ms=800emu/cc, d=1nm
Then, the test formula is (J/muB)*(muB/Msd)*IntISGE/(Cxx/d)*10^12...this \
gives the torque efficiency in Oe/(10^8A/cm2).
The effective spin Hall conductance reads J*IntISGE*(2*e/hbar)*10^-4...this \
gives the spin Hall conductivity in (\\hbar/2e) 10^4 Ohm^-1.m^-1

Note: looks like n=300 is the best, but n=200 is ok; n=100 is too small\
\>", "Text",
 CellChangeTimes->{{3.719809899704392*^9, 3.7198099473580847`*^9}, {
  3.719817627732584*^9, 3.7198176456819887`*^9}, {3.719817804617263*^9, 
  3.719817848692037*^9}, {3.7198254580753508`*^9, 3.719825517168387*^9}, {
  3.719825620793806*^9, 3.719825622809182*^9}, {3.719825668513103*^9, 
  3.7198257353223143`*^9}, {3.7198258042736683`*^9, 3.7198258262563143`*^9}, {
  3.719825962792598*^9, 3.719826027818473*^9}, {3.719826113851697*^9, 
  3.7198261224148693`*^9}, {3.71982837697143*^9, 3.719828427986615*^9}, {
  3.720225984706077*^9, 3.720226004641448*^9}, {3.7202279460374193`*^9, 
  3.7202279467144737`*^9}, {3.720413415132512*^9, 3.720413435763296*^9}, {
  3.732352011045285*^9, 
  3.732352019329372*^9}},ExpressionUUID->"44324ae8-b462-4891-9040-\
9ff3d30ac672"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Hopping parameters according to Slater ",
 StyleBox["Koster",
  IgnoreSpellCheck->True],
 " "
}], "Section",
 CellChangeTimes->{{3.732768724001671*^9, 3.73276875793782*^9}, 
   3.732768847276126*^9},ExpressionUUID->"fae30207-e598-47de-bf1e-\
e4beb3a1288f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gxyF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "*", "VsF2"}], "+", "VdF2"}], ")"}], "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gxzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"VpF2", "+", "VdF2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gyzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"VpF2", "+", "VdF2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{"2", "*", "VpF2", " ", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gz2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"VsF2", "+", 
       RowBox[{"3", "*", "VdF2"}]}], ")"}], "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gxyN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "*", "VsN2"}], "+", "VdN2"}], ")"}], "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gxzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"VpN2", "+", "VdN2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gyzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"VpN2", "+", "VdN2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{"2", "*", "VpN2", " ", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gz2N", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"VsN2", "+", 
        RowBox[{"3", "*", "VdN2"}]}], ")"}], "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kx", "+", "ky"}], ")"}], "*", 
         RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"kx", "-", "ky"}], ")"}], "*", 
         RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "here", " ", "we", " ", "are", " ", "considered", " ", "the", " ", 
     "diagonal", " ", "elements", 
     RowBox[{
      RowBox[{"(", "g", ")"}], ".", " ", "nearest"}], " ", "neighor", " ", 
     "in", " ", "a", " ", "sheet", " ", "is", " ", "the", " ", "second", " ", 
     "nearest", " ", "neighbor", " ", "in", " ", "the", " ", "BCC", " ", 
     "structure", " ", "and", " ", "thats", " ", "why", " ", "we", " ", "use",
      " ", 
     RowBox[{"VsF2", ".", " ", "the"}], " ", "correct", " ", "formula", " ", 
     "depends", " ", "on", " ", "the", " ", "orientation", " ", "in", " ", 
     "space", " ", "and", " ", "in", " ", "our", " ", "case", " ", "we", " ", 
     "have", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[PlusMinus]", "1"}], ",", 
       RowBox[{"\[PlusMinus]", "1"}], ",", "0"}], ")"}]}], ",", 
    RowBox[{
    "in", " ", "gxzF", " ", "and", " ", "gyzF", " ", "we", " ", "exploited", 
     " ", "the", " ", "symmery", " ", "to", " ", "xy"}], ",", 
    RowBox[{"xy", 
     RowBox[{"(", "011", ")"}]}], " ", ",", " ", 
    RowBox[{"our", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes", " ", "are", " ", "rotated", " ", "by", " ", 
     SuperscriptBox["45", "o"], " ", "to", " ", "get", " ", "the", " ", 
     "values", " ", "from", " ", "the", " ", "table", " ", 
     RowBox[{"directly", ".", " ", "T"}], " ", "refers", " ", "to", " ", "a", 
     " ", "state", " ", "in", " ", "the", " ", "same", " ", "sheet"}]}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyFxzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyFyzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxzFyzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"VpF2", "-", "VdF2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyFx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TyzFx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxzFx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tz2Fx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyFz2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"VsF2", "-", "VdF2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TyzFz2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TxzFz2F", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyNxzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyNyzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxzNyzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"VpN2", "-", "VdN2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyNx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TyzNx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxzNx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tz2Nx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyNz2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"VsN2", "-", "VdN2"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "-", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TyzNz2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TxzNz2N", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TxyFxyN", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VpFN1", "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", 
       RowBox[{"VdFN1", "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"kx", "*", 
         RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"ky", "*", 
         RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"eta", " ", "here", " ", "is", " ", 
     RowBox[{"Pi", "/", "4"}], " ", "and", " ", "it", " ", "just", " ", 
     "cancels", " ", "the", " ", "2", " ", "factor", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "no", " ", "need", " ", "for", " ", "this", " ", "tricky", " ", 
         "notation", " ", "since", " ", "we", " ", "get", " ", "the", " ", 
         "coefficient", " ", "from", " ", "the", " ", "S"}], "-", 
        RowBox[{"K", " ", "formulae"}]}], ")"}], ".", " ", "also"}], " ", 
     SubscriptBox["K", "z"], " ", 
     RowBox[{"doesn", "'"}], "t", " ", "affect", " ", "our", " ", 
     "calculations", " ", "and", " ", "for", " ", "simplicity", " ", 
     SubscriptBox["K", "z"]}], "=", "0"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TyzFyzN", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VpFN1", "*", 
         RowBox[{
          RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}], "+", 
        RowBox[{"VdFN1", "*", 
         RowBox[{
          RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"kx", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "*", "VsFN1"}], "+", "VdFN1", "-", 
           RowBox[{"4", "*", "VpFN1"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}], "*", 
         RowBox[{
          RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", "VpFN1"}], 
       ")"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "previous", " ", "formula", " ", "can", " ", "be", " ", 
    "simlified", " ", "and", " ", "actually", " ", "VpFN1", " ", "will", " ", 
    "cancel", " ", "out"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TxzFxzN", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VpFN1", "*", 
         RowBox[{
          RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}], "+", 
        RowBox[{"VdFN1", "*", 
         RowBox[{
          RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "*", "VsFN1"}], "+", "VdFN1", "-", 
           RowBox[{"4", "*", "VpFN1"}]}], ")"}], "*", 
         RowBox[{
          RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}], "*", 
         RowBox[{
          RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", "VpFN1"}], 
       ")"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"kx", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"by", " ", "symmetry", " ", 
     RowBox[{"it", "'"}], "s", " ", "identical", " ", "to", " ", "yz"}], ",", 
    "yz"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxzFyzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TyzFxzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyFxzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpFN1", "-", "VdFN1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyFyzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpFN1", "-", "VdFN1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxzFxyN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpFN1", "-", "VdFN1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TyzFxyN", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "2"}], "*", "I", "*", 
     RowBox[{"Sin", "[", "eta", "]"}], "*", 
     RowBox[{"Cos", "[", "eta", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"VpFN1", "-", "VdFN1"}], ")"}], "*", 
     RowBox[{"Sin", "[", 
      RowBox[{"kx", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"why", " ", "we", " ", "have"}], " ", "-", 
     RowBox[{"i", " ", "instead", " ", "of", " ", "i"}]}], ",", " ", 
    RowBox[{"and", " ", "does", " ", "that", " ", "actually", " ", 
     RowBox[{"matters", "?"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyFx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TyzFx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "VdFN1"}], "+", 
      RowBox[{"3", " ", "VsFN1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdFN1", "-", 
         RowBox[{"4", " ", "VpFN1"}], "+", 
         RowBox[{"3", " ", "VsFN1"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxzFx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "I"}], "/", "4"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "VdFN1"}], "+", 
      RowBox[{"3", " ", "VsFN1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdFN1", "-", 
         RowBox[{"4", " ", "VpFN1"}], "+", 
         RowBox[{"3", " ", "VsFN1"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tz2Fx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], " ", "*", 
     SqrtBox["3"], " ", 
     RowBox[{
      RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "VdFN1"}], "+", 
       RowBox[{"VsFN1", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"VdFN1", "-", 
          RowBox[{"4", " ", "VpFN1"}], "+", 
          RowBox[{"2", " ", "VsFN1"}]}], ")"}], " ", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"kx", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "4"}], "*", " ", 
     SqrtBox["3"], " ", 
     RowBox[{
      RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "VdFN1"}], "+", 
       RowBox[{"4", " ", "VpFN1"}], "-", "VsFN1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"VdFN1", "-", 
          RowBox[{"4", " ", "VpFN1"}], "+", 
          RowBox[{"3", " ", "VsFN1"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"ky", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tx2y2Fx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "/", "2"}], " ", "VsFN1", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "4"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "8"}], ")"}], " ", "VdFN1", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "eta"}], "]"}]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{"2", "VpFN1", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], "  ", 
       RowBox[{
        RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"kx", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxyFz2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TyzFz2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", "3", "]"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{"VdFN1", "-", "VsFN1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdFN1", "-", 
         RowBox[{"4", " ", "VpFN1"}], "+", 
         RowBox[{"3", " ", "VsFN1"}]}], ")"}], " ", "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TxzFz2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", "3", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VdFN1", "-", "VsFN1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdFN1", "-", 
         RowBox[{"4", " ", "VpFN1"}], "+", 
         RowBox[{"3", " ", "VsFN1"}]}], ")"}], "*", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tz2Fz2N", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"3", "/", "2"}], " ", "VdFN1", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "4"}]}], "+", 
       RowBox[{
        RowBox[{"1", "/", "8"}], " ", "VsFN1", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"3", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], "^", "2"}]}], "+", 
       RowBox[{"6", " ", "VpFN1", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"kx", "*", 
         RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"ky", "*", 
         RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyNxyN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{"2", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"VpN1", "*", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", 
      RowBox[{"VdN1", "*", 
       RowBox[{
        RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"kx", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzNyzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VpN1", "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}], "+", 
       RowBox[{"VdN1", "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"kx", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", "VsN1"}], "+", "VdN1", "-", 
          RowBox[{"4", "*", "VpN1"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}], "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", "VpN1"}], ")"}],
      "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"ky", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzNxzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VpN1", "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}], "+", 
       RowBox[{"VdN1", "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"ky", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", "VsN1"}], "+", "VdN1", "-", 
          RowBox[{"4", "*", "VpN1"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}], "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", "VpN1"}], ")"}],
      "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"kx", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzNyzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzNxzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyNxzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpN1", "-", "VdN1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyNyzN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpN1", "-", "VdN1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzNxyN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpN1", "-", "VdN1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzNxyN", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpN1", "-", "VdN1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyNx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzNx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "VdN1"}], "+", 
      RowBox[{"3", " ", "VsN1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdN1", "-", 
         RowBox[{"4", " ", "VpN1"}], "+", 
         RowBox[{"3", " ", "VsN1"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzNx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "I"}], "/", "4"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "VdN1"}], "+", 
      RowBox[{"3", " ", "VsN1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdN1", "-", 
         RowBox[{"4", " ", "VpN1"}], "+", 
         RowBox[{"3", " ", "VsN1"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTz2Nx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], " ", "*", 
     SqrtBox["3"], " ", 
     RowBox[{
      RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "VdN1"}], "+", 
       RowBox[{"VsN1", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"VdN1", "-", 
          RowBox[{"4", " ", "VpN1"}], "+", 
          RowBox[{"2", " ", "VsN1"}]}], ")"}], "*", " ", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"kx", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "4"}], "*", " ", 
     SqrtBox["3"], " ", 
     RowBox[{
      RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "VdN1"}], "+", 
       RowBox[{"4", " ", "VpN1"}], "-", "VsN1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"VdN1", "-", 
          RowBox[{"4", " ", "VpN1"}], "+", 
          RowBox[{"3", " ", "VsN1"}]}], ")"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"ky", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTx2y2Nx2y2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "/", "2"}], " ", "VsN1", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "4"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "8"}], ")"}], " ", "VdN1", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "eta"}], "]"}]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{"2", "VpN1", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], "  ", 
       RowBox[{
        RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"kx", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyNz2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzNz2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", "3", "]"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{"VdN1", "-", "VsN1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdN1", "-", 
         RowBox[{"4", " ", "VpN1"}], "+", 
         RowBox[{"3", " ", "VsN1"}]}], ")"}], " ", "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzNz2N", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", "3", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VdN1", "-", "VsN1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdN1", "-", 
         RowBox[{"4", " ", "VpN1"}], "+", 
         RowBox[{"3", " ", "VsN1"}]}], ")"}], "*", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zTz2Nz2N", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"3", "/", "2"}], " ", "VdN1", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "4"}]}], "+", 
       RowBox[{
        RowBox[{"1", "/", "8"}], " ", "VsN1", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"3", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], "^", "2"}]}], "+", 
       RowBox[{"6", " ", "VpN1", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"kx", "*", 
         RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"ky", "*", 
         RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyFxyF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{"2", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"VpF1", "*", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", 
      RowBox[{"VdF1", "*", 
       RowBox[{
        RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"kx", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzFyzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VpF1", "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}], "+", 
       RowBox[{"VdF1", "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"kx", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", "VsF1"}], "+", "VdF1", "-", 
          RowBox[{"4", "*", "VpF1"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}], "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", "VpF1"}], ")"}],
      "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"ky", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzFxzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VpF1", "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}], "+", 
       RowBox[{"VdF1", "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"ky", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", "VsF1"}], "+", "VdF1", "-", 
          RowBox[{"4", "*", "VpF1"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}], "*", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "+", "VpF1"}], ")"}],
      "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"kx", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzFyzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzFxzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyFxzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpF1", "-", "VdF1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyFyzF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpF1", "-", "VdF1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzFxyF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpF1", "-", "VdF1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzFxyF", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], "*", "I", "*", 
    RowBox[{"Sin", "[", "eta", "]"}], "*", 
    RowBox[{"Cos", "[", "eta", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VpF1", "-", "VdF1"}], ")"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyFx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzFx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "VdF1"}], "+", 
      RowBox[{"3", " ", "VsF1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdF1", "-", 
         RowBox[{"4", " ", "VpF1"}], "+", 
         RowBox[{"3", " ", "VsF1"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzFx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "I"}], "/", "4"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "VdF1"}], "+", 
      RowBox[{"3", " ", "VsF1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdF1", "-", 
         RowBox[{"4", " ", "VpF1"}], "+", 
         RowBox[{"3", " ", "VsF1"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTz2Fx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], " ", "*", 
     SqrtBox["3"], " ", 
     RowBox[{
      RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "VdF1"}], "+", 
       RowBox[{"VsF1", " ", 
        RowBox[{
         RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"VdF1", "-", 
          RowBox[{"4", " ", "VpF1"}], "+", 
          RowBox[{"2", " ", "VsF1"}]}], ")"}], " ", 
        RowBox[{
         RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"kx", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "4"}], "*", " ", 
     SqrtBox["3"], " ", 
     RowBox[{
      RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", "VdF1"}], "+", 
       RowBox[{"4", " ", "VpF1"}], "-", "VsF1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"VdF1", "-", 
          RowBox[{"4", " ", "VpF1"}], "+", 
          RowBox[{"3", " ", "VsF1"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"ky", "*", 
       RowBox[{"a0", "/", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTx2y2Fx2y2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "/", "2"}], " ", "VsF1", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "4"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "8"}], ")"}], " ", "VdF1", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "eta"}], "]"}]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{"2", "VpF1", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], "  ", 
       RowBox[{
        RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"kx", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], "  ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxyFz2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTyzFz2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", "3", "]"}], "*", " ", 
    RowBox[{"(", 
     RowBox[{"VdF1", "-", "VsF1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdF1", "-", 
         RowBox[{"4", " ", "VpF1"}], "+", 
         RowBox[{"3", " ", "VsF1"}]}], ")"}], " ", "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"ky", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTxzFz2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"I", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", "3", "]"}], "*", 
    RowBox[{"(", 
     RowBox[{"VdF1", "-", "VsF1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"VdF1", "-", 
         RowBox[{"4", " ", "VpF1"}], "+", 
         RowBox[{"3", " ", "VsF1"}]}], ")"}], "*", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], " ", "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "eta"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"kx", "*", 
      RowBox[{"a0", "/", "2"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zTz2Fz2F", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"3", "/", "2"}], " ", "VdF1", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "4"}]}], "+", 
      RowBox[{
       RowBox[{"1", "/", "8"}], " ", "VsF1", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"3", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "eta"}], "]"}]}]}], ")"}], "^", "2"}]}], "+", 
      RowBox[{"6", " ", "VpF1", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "eta", "]"}], "^", "2"}], " ", 
       RowBox[{
        RowBox[{"Sin", "[", "eta", "]"}], "^", "2"}]}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"kx", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}], "+", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", "*", 
        RowBox[{"a0", "/", "2"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.715761864942608*^9, 3.715762073068891*^9}, {
   3.715762170015504*^9, 3.715762194609024*^9}, {3.715762227534525*^9, 
   3.7157622296016827`*^9}, {3.715769703240306*^9, 3.715769707562693*^9}, {
   3.7157697403698*^9, 3.715769761919725*^9}, {3.715769982047876*^9, 
   3.71577000802103*^9}, {3.715770048694599*^9, 3.715770060170328*^9}, {
   3.715770124956552*^9, 3.715770147828196*^9}, {3.715774441317149*^9, 
   3.715774447604838*^9}, {3.715774510505015*^9, 3.715774536461945*^9}, {
   3.7157746602250032`*^9, 3.715774698531167*^9}, {3.715774770472931*^9, 
   3.715774784063876*^9}, {3.715774854365953*^9, 3.7157748639308853`*^9}, {
   3.715774911848535*^9, 3.715774921169651*^9}, {3.715774989401219*^9, 
   3.715775026515737*^9}, {3.715775369052889*^9, 3.7157753721697607`*^9}, 
   3.7157754467767153`*^9, {3.715775501061157*^9, 3.715775501400352*^9}, {
   3.715775544602449*^9, 3.715775643924865*^9}, {3.7165486729869328`*^9, 
   3.71654873053201*^9}, 3.7165488203336697`*^9, {3.71654897643713*^9, 
   3.716549001745687*^9}, {3.716549048652766*^9, 3.716549083816161*^9}, {
   3.7165491415887127`*^9, 3.716549145141596*^9}, {3.716549305903119*^9, 
   3.716549380939652*^9}, {3.7167076722958517`*^9, 3.7167077259648237`*^9}, {
   3.7167106437974663`*^9, 3.7167106676034517`*^9}, {3.716710712196467*^9, 
   3.716710883495414*^9}, {3.716710947901257*^9, 3.7167115099026413`*^9}, {
   3.7186405847557707`*^9, 3.718640611778943*^9}, {3.718641132478348*^9, 
   3.718641186638764*^9}, {3.718642708600165*^9, 3.718642754160334*^9}, 
   3.718850465123604*^9, {3.719809792441091*^9, 3.719809795840818*^9}, {
   3.7198182870846977`*^9, 3.719818287602906*^9}, {3.7198227376369877`*^9, 
   3.71982274336121*^9}, {3.7200044791808443`*^9, 3.7200044803560457`*^9}, {
   3.7202211521313543`*^9, 3.720221207954097*^9}, {3.72022176265662*^9, 
   3.7202218014088306`*^9}, {3.720221838006576*^9, 3.720221863461664*^9}, {
   3.720224916020191*^9, 3.720224949597258*^9}, {3.7202280909523478`*^9, 
   3.720228147287904*^9}, 3.732769064960443*^9, {3.732788804411849*^9, 
   3.732788864532061*^9}, {3.7347457413316793`*^9, 3.7347457446143103`*^9}, {
   3.734746077631855*^9, 3.7347461824741087`*^9}, {3.734773904215163*^9, 
   3.734774010436058*^9}, {3.734774065233932*^9, 3.734774086035653*^9}, {
   3.736759195923502*^9, 3.736759367039843*^9}, {3.7370826708072453`*^9, 
   3.73708273123244*^9}, {3.737278155639207*^9, 3.737278297081435*^9}, {
   3.737278329487411*^9, 3.73727857262529*^9}, {3.7372786080653477`*^9, 
   3.7372786230781603`*^9}, {3.7372786956089897`*^9, 3.737278750495524*^9}, {
   3.737278797749816*^9, 3.7372788566265583`*^9}, {3.737278920835311*^9, 
   3.737279006607904*^9}, {3.737279063729553*^9, 3.7372791203041763`*^9}, {
   3.7372792905793047`*^9, 3.737279297691598*^9}, {3.737279348080258*^9, 
   3.7372794272826147`*^9}, {3.737279506671568*^9, 3.7372796000341682`*^9}, {
   3.737279914276613*^9, 3.737280067937929*^9}, {3.737280159830718*^9, 
   3.7372803332795267`*^9}, {3.73728038702423*^9, 3.737280413214761*^9}, {
   3.737280498924487*^9, 3.737280633722844*^9}, {3.737280707034645*^9, 
   3.7372807622899647`*^9}, {3.737280863072188*^9, 3.737280902851163*^9}, {
   3.737280945125732*^9, 3.737280945555098*^9}, {3.737281144678426*^9, 
   3.737281442062643*^9}, {3.737283889716748*^9, 3.737283897940414*^9}, {
   3.737623343546665*^9, 3.7376234269383993`*^9}, {3.737774123630156*^9, 
   3.7377741739300756`*^9}, {3.737774312131744*^9, 3.737774312607909*^9}, {
   3.737781804983788*^9, 3.737781835223024*^9}, {3.737781871653388*^9, 
   3.737781943073989*^9}, {3.737782010428667*^9, 3.737782016561286*^9}, {
   3.737782050628523*^9, 3.737782088491414*^9}, {3.737782278378068*^9, 
   3.73778230821213*^9}, {3.737782389213133*^9, 3.737782440705077*^9}, {
   3.737782690527698*^9, 3.7377827622673683`*^9}, {3.7377828146218023`*^9, 
   3.737782952372375*^9}, {3.7377842554808283`*^9, 3.7377842937715282`*^9}, {
   3.737784535064123*^9, 3.7377845536194468`*^9}, 3.737784797738577*^9, {
   3.7377848612069893`*^9, 3.7377848631906347`*^9}, 3.7377851765846043`*^9, 
   3.737785322272045*^9, {3.739090144349622*^9, 
   3.739090244982147*^9}},ExpressionUUID->"e2ece989-a252-4d4e-8093-\
8eb537b3f0d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Single Multilayer Hamiltonian", "Section",
 CellChangeTimes->{{3.732769080486744*^9, 
  3.7327691157419577`*^9}},ExpressionUUID->"67a0b0f3-f9f1-4452-a252-\
1eb883391e95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MF", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ExyF", "+", 
         RowBox[{
          RowBox[{"JxyF", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gxyF", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"JxyF", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"TxyFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"JxyF", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"ExyF", "-", 
         RowBox[{
          RowBox[{"JxyF", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gxyF", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
        RowBox[{"TxyFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TxyFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"ExzF", "+", 
         RowBox[{
          RowBox[{"JxzF", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gxzF", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"JxzF", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"TxzFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TxyFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", 
        RowBox[{
         RowBox[{"JxzF", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"ExzF", "-", 
         RowBox[{
          RowBox[{"JxzF", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gxzF", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
        RowBox[{"TxzFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TxyFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"EyzF", "+", 
         RowBox[{
          RowBox[{"JyzF", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gyzF", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"JyzF", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"TyzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TxyFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", 
        RowBox[{
         RowBox[{"JyzF", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"EyzF", "-", 
         RowBox[{
          RowBox[{"JyzF", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gyzF", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
        RowBox[{"TyzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TxyFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Ez2F", "+", 
         RowBox[{
          RowBox[{"Jz2F", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gz2F", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Jz2F", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"Tz2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TxyFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Jz2F", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"Ez2F", "-", 
         RowBox[{
          RowBox[{"Jz2F", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gz2F", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
        RowBox[{"Tz2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TxyFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tz2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Ex2y2F", "+", 
         RowBox[{
          RowBox[{"Jx2y2F", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gx2y2F", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Jx2y2F", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "I"}], "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TxyFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tz2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Jx2y2F", "/", "2"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"I", "*", "fi"}], "]"}], "*", 
         RowBox[{"Sin", "[", "th", "]"}]}], ",", 
        RowBox[{"Ex2y2F", "-", 
         RowBox[{
          RowBox[{"Jx2y2F", "/", "2"}], "*", 
          RowBox[{"Cos", "[", "th", "]"}]}], "+", 
         RowBox[{"gx2y2F", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msoc", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "I", ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
        RowBox[{"2", "I"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "I", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "2"}], "I"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "I"}], ",", "0", ",", "0", ",", 
        RowBox[{"-", "I"}], ",", "0", ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", "1"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "I"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "I", 
        ",", 
        RowBox[{"Sqrt", "[", "3", "]"}], ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "1", ",", "I", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"I", " ", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", "I"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
        RowBox[{"-", "I"}], ",", "0", ",", "0", ",", 
        RowBox[{"I", " ", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", "I", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"Sqrt", "[", "3", "]"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", "0", ",", "0", ",",
         "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", "0", ",", "0", ",",
         "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "I"}], ",", "0", ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", 
        RowBox[{"-", "I"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"2", " ", "I"}], ",", "1", ",", "0", ",", 
        RowBox[{"-", "I"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MN", "[", 
     RowBox[{"kx_", ",", "ky_", ",", "i_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ExyN", "+", 
          RowBox[{"gxyN", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
         RowBox[{"TxyNxzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxyNyzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxyNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxyNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"ExyN", "+", 
          RowBox[{"gxyN", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
         RowBox[{"TxyNxzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxyNyzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxyNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxyNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"TxyNxzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"ExzN", "+", 
          RowBox[{"gxzN", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
         RowBox[{"TxzNyzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"TxyNxzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"ExzN", "+", 
          RowBox[{"gxzN", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
         RowBox[{"TxzNyzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"TxyNyzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNyzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"EyzN", "+", 
          RowBox[{"gyzN", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
         RowBox[{"TyzNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TyzNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"TxyNyzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNyzN", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"EyzN", "+", 
          RowBox[{"gyzN", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
         RowBox[{"TyzNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TyzNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"TxyNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TyzNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"Ez2N", "+", 
          RowBox[{"gz2N", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
         RowBox[{"Tz2Nx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"TxyNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TyzNz2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"Ez2N", "+", 
          RowBox[{"gz2N", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0", ",", 
         RowBox[{"Tz2Nx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"TxyNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TyzNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"Tz2Nx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"Ex2y2N", "+", 
          RowBox[{"gx2y2N", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}], ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"TxyNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TxzNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"TyzNx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"Tz2Nx2y2N", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
         RowBox[{"Ex2y2N", "+", 
          RowBox[{"gx2y2N", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}]}]}], "}"}]}], "}"}], "+", 
     RowBox[{
      RowBox[{"ch", "[", "i", "]"}], "Msoc"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mff", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTxyFxyF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTxyFxyF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTxzFxyF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTxzFxyF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTyzFxyF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTyzFxyF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFxzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFyzF", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTxyFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Fz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTxyFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Fz2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTxyFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTx2y2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTxyFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzFx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTx2y2Fx2y2F", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mfn", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TxyFxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TxyFxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxyFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TxzFxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TxzFxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TyzFxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TyzFxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TxyFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tz2Fz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tz2Fx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TxyFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tz2Fz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tz2Fx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TxyFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tz2Fx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tx2y2Fx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"TxyFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TxzFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"TyzFx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tz2Fx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"Tx2y2Fx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mnn", "[", 
     RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTxyNxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyNxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyNyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTxyNxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyNxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyNyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxyNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTxzNxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTxzNxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTyzNxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTyzNxyN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNxzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNyzN", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTxyNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Nz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Nx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTxyNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Nz2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Nx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"zTxyNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Nx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTx2y2Nx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"zTxyNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTxzNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTyzNx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTz2Nx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ",", "0", ",", 
        RowBox[{"zTx2y2Nx2y2N", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"don", "'"}], "t", " ", "change", " ", "the", " ", 
     RowBox[{"electron", "'"}], "s", " ", "dynamics"}], ",", " ", 
    RowBox[{
    "because", " ", "k", " ", "is", " ", "in", " ", "the", " ", "xy", " ", 
     "plane"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mnn2", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "VdN2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "VdN2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "VpN2", ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "VpN2", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "VpN2", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "VpN2", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "VsN2", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "VsN2", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "VdN2", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "VdN2"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mff2", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "VdF2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "VdF2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "VpF2", ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "VpF2", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "VpF2", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "VpF2", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "VsF2", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "VsF2", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "VdF2", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "VdF2"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mfn2", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "VdFN2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "VdFN2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "VpFN2", ",", "0", ",", "0", ",", "0", ",", "0", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "VpFN2", ",", "0", ",", "0", ",", "0", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "VpFN2", ",", "0", ",", "0", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "VpFN2", ",", "0", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "VsFN2", 
       ",", "0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "VsFN2", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "VdFN2", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "VdFN2"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.715761864942608*^9, 3.715762073068891*^9}, {
   3.715762170015504*^9, 3.715762194609024*^9}, {3.715762227534525*^9, 
   3.7157622296016827`*^9}, {3.715769703240306*^9, 3.715769707562693*^9}, {
   3.7157697403698*^9, 3.715769761919725*^9}, {3.715769982047876*^9, 
   3.71577000802103*^9}, {3.715770048694599*^9, 3.715770060170328*^9}, {
   3.715770124956552*^9, 3.715770147828196*^9}, {3.715774441317149*^9, 
   3.715774447604838*^9}, {3.715774510505015*^9, 3.715774536461945*^9}, {
   3.7157746602250032`*^9, 3.715774698531167*^9}, {3.715774770472931*^9, 
   3.715774784063876*^9}, {3.715774854365953*^9, 3.7157748639308853`*^9}, {
   3.715774911848535*^9, 3.715774921169651*^9}, {3.715774989401219*^9, 
   3.715775026515737*^9}, {3.715775369052889*^9, 3.7157753721697607`*^9}, 
   3.7157754467767153`*^9, {3.715775501061157*^9, 3.715775501400352*^9}, {
   3.715775544602449*^9, 3.715775643924865*^9}, {3.7165486729869328`*^9, 
   3.71654873053201*^9}, 3.7165488203336697`*^9, {3.71654897643713*^9, 
   3.716549001745687*^9}, {3.716549048652766*^9, 3.716549083816161*^9}, {
   3.7165491415887127`*^9, 3.716549145141596*^9}, {3.716549305903119*^9, 
   3.716549380939652*^9}, {3.7167076722958517`*^9, 3.7167077259648237`*^9}, {
   3.7167106437974663`*^9, 3.7167106676034517`*^9}, {3.716710712196467*^9, 
   3.716710883495414*^9}, {3.716710947901257*^9, 3.7167115099026413`*^9}, {
   3.7186405847557707`*^9, 3.718640611778943*^9}, {3.718641132478348*^9, 
   3.718641186638764*^9}, {3.718642708600165*^9, 3.718642754160334*^9}, 
   3.718850465123604*^9, {3.719809792441091*^9, 3.719809795840818*^9}, {
   3.7198182870846977`*^9, 3.719818287602906*^9}, {3.7198227376369877`*^9, 
   3.71982274336121*^9}, {3.7200044791808443`*^9, 3.7200044803560457`*^9}, {
   3.7202211521313543`*^9, 3.720221207954097*^9}, {3.72022176265662*^9, 
   3.7202218014088306`*^9}, {3.720221838006576*^9, 3.720221863461664*^9}, {
   3.720224916020191*^9, 3.720224949597258*^9}, {3.7202280909523478`*^9, 
   3.720228147287904*^9}, 3.732769064960443*^9, {3.732769152399548*^9, 
   3.7327691534664392`*^9}, {3.732769222285136*^9, 3.732769235344409*^9}, {
   3.7327692751950293`*^9, 3.732769310747664*^9}, {3.733389399759796*^9, 
   3.7333894751981583`*^9}, {3.733394610088994*^9, 3.733394650384718*^9}, {
   3.733395420961904*^9, 3.733395458211752*^9}, {3.7333954891632023`*^9, 
   3.733395505298485*^9}, 3.7333960363128977`*^9, 3.733396300182538*^9, {
   3.733400127664576*^9, 3.733400168678822*^9}, {3.73474595806896*^9, 
   3.734746055160371*^9}, {3.734785892311977*^9, 3.7347859280505238`*^9}, {
   3.7347859788004713`*^9, 3.7347860000365973`*^9}, {3.734786049095545*^9, 
   3.734786261160801*^9}, {3.734786342536994*^9, 3.7347863519922667`*^9}, {
   3.736759417817535*^9, 3.736759422162676*^9}, {3.736759718312583*^9, 
   3.7367600041557417`*^9}, {3.736760357523831*^9, 3.736760360377801*^9}, {
   3.736762007772297*^9, 3.73676235237988*^9}, {3.736762382699542*^9, 
   3.7367624461602097`*^9}, {3.736762491045946*^9, 3.736762504661715*^9}, {
   3.7367636638061733`*^9, 3.736763668968474*^9}, {3.737082409794799*^9, 
   3.7370824514556513`*^9}, 3.7370859194383583`*^9, {3.737267617478366*^9, 
   3.73726786934829*^9}, {3.737267904622858*^9, 3.737267977537616*^9}, {
   3.7372681542210617`*^9, 3.737268158796064*^9}, {3.7372819992138968`*^9, 
   3.7372821099036903`*^9}, {3.737282162221839*^9, 3.7372824087780037`*^9}, {
   3.737282928095517*^9, 3.737283086709056*^9}, {3.737283117300068*^9, 
   3.7372831518180656`*^9}, {3.73728318425181*^9, 3.73728321116707*^9}, {
   3.737283333651585*^9, 3.737283520096272*^9}, {3.737283582014977*^9, 
   3.737283825887014*^9}, {3.737283915053421*^9, 3.737283924992334*^9}, {
   3.737284643353716*^9, 3.737284880691311*^9}, {3.737284923379283*^9, 
   3.737285169650647*^9}, {3.737285202126164*^9, 3.737285469655352*^9}, {
   3.737285525443334*^9, 3.7372860624190693`*^9}, {3.7372861118273363`*^9, 
   3.737286306109005*^9}, 3.7372869723931837`*^9, {3.7372874844826097`*^9, 
   3.737287520968739*^9}, {3.737288200952053*^9, 3.737288202835644*^9}, {
   3.737785792179386*^9, 
   3.737785795750907*^9}},ExpressionUUID->"c2a68c2c-9f49-420e-a674-\
b9395a5f2ddc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full Hamiltonian", "Section",
 CellChangeTimes->{{3.732766079209841*^9, 3.732766157778754*^9}, {
   3.732768418622903*^9, 3.7327684202378197`*^9}, {3.73276910396723*^9, 
   3.7327691050778723`*^9}, 
   3.732786818275457*^9},ExpressionUUID->"0e020bf4-c4af-4ab4-884f-\
fe13e2382ae6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
   "we", " ", "require", " ", "at", " ", "least", " ", "3", " ", "layers", 
    " ", "here", " ", "for", " ", "both", " ", "ferro", " ", "and", " ", 
    "metal"}], " ", "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MNT", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MN", "[", 
        RowBox[{"kx", ",", "ky", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nbN"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MnnT", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mnn", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nbN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mnn2T", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"Mnn2", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nbN"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Hn", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", " ", 
     RowBox[{"LSlab", "[", 
      RowBox[{
       RowBox[{"MNT", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], ",", 
       RowBox[{"MnnT", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], ",", "Mnn2T"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hf", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", " ", 
     RowBox[{"Slab", "[", 
      RowBox[{"nbF", ",", 
       RowBox[{"MF", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], ",", 
       RowBox[{"Mff", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], ",", "Mff2"}], "]"}]}], ";"}], "\n",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Htr", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Mfn2", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"10", ",", "10"}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Mfn", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], ",", "Mfn2"}], "}"}]}], "}"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"H", "[", 
      RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
     RowBox[{"Combine", "[", 
      RowBox[{
       RowBox[{"Hf", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], ",", 
       RowBox[{"Hn", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], ",", 
       RowBox[{"Htr", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"H", "[", 
       RowBox[{"kx_", ",", "ky_"}], "]"}], "=", " ", 
      RowBox[{"Hf", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}]}], ";"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.737627810629936*^9, 3.737627835499104*^9}, {
   3.737695909789*^9, 3.737695923858921*^9}, 3.737698815374868*^9, {
   3.7376992964595213`*^9, 3.7376993235690804`*^9}, {3.737707467439583*^9, 
   3.737707544569025*^9}, {3.7377095371365967`*^9, 3.737709554760199*^9}, 
   3.737709610589944*^9, 3.737711258932035*^9, {3.73771248208468*^9, 
   3.737712520193128*^9}, {3.737794159818959*^9, 3.7377941616568108`*^9}, {
   3.7377950545199623`*^9, 3.737795059908008*^9}, {3.737796591195118*^9, 
   3.737796600209218*^9}, {3.737869444856843*^9, 3.7378694677877827`*^9}, {
   3.73786984736471*^9, 3.7378698665068827`*^9}, {3.7378700877985907`*^9, 
   3.737870096553095*^9}, {3.7379712943209887`*^9, 3.7379712995715857`*^9}, {
   3.737971362733343*^9, 3.7379713645693817`*^9}, {3.737971401365459*^9, 
   3.7379714072853737`*^9}, {3.737971577281476*^9, 3.737971581673943*^9}, {
   3.737972245975397*^9, 3.737972318196512*^9}, {3.7379723634274817`*^9, 
   3.737972413459127*^9}, {3.737972585048287*^9, 3.737972596043264*^9}, {
   3.73797273752061*^9, 3.73797274871318*^9}, {3.738213362012649*^9, 
   3.738213362271923*^9}, {3.738223305348113*^9, 
   3.73822331594976*^9}},ExpressionUUID->"b3e90460-60a9-404b-898a-\
30766fcc1adc"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Dimension of the matrices:\"\>"], "Print",
 CellChangeTimes->{
  3.738212431579116*^9, 3.738213367331066*^9, 3.7382233170411797`*^9, 
   3.738470500304206*^9, 3.738471946511137*^9, 3.738476944287079*^9, 
   3.7384824849408207`*^9, {3.738482611752043*^9, 3.738482616254973*^9}, 
   3.738482826736617*^9, 3.738994728536853*^9, 3.7389948263711367`*^9, 
   3.738995094909626*^9, 3.738995294693553*^9, 
   3.7389954799923077`*^9},ExpressionUUID->"fc3ef0c9-7598-41c7-bc9d-\
8c61ccfc4e44"],

Cell[BoxData["\<\"t0 :[[10, 10]]\\nt1 :[[10, 10]]\\nt2 :[[10, 10]]\\nt3 :[]\"\
\>"], "Print",
 CellChangeTimes->{
  3.738212431579116*^9, 3.738213367331066*^9, 3.7382233170411797`*^9, 
   3.738470500304206*^9, 3.738471946511137*^9, 3.738476944287079*^9, 
   3.7384824849408207`*^9, {3.738482611752043*^9, 3.738482616254973*^9}, 
   3.738482826736617*^9, 3.738994728536853*^9, 3.7389948263711367`*^9, 
   3.738995094909626*^9, 3.738995294693553*^9, 
   3.7389954799929113`*^9},ExpressionUUID->"0e81cfc2-ce79-4f53-ab4c-\
7f8e24c48999"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of blocks         : \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Number of blocks         : ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.738212431579116*^9, 3.738213367331066*^9, 3.7382233170411797`*^9, 
   3.738470500304206*^9, 3.738471946511137*^9, 3.738476944287079*^9, 
   3.7384824849408207`*^9, {3.738482611752043*^9, 3.738482616254973*^9}, 
   3.738482826736617*^9, 3.738994728536853*^9, 3.7389948263711367`*^9, 
   3.738995094909626*^9, 3.738995294693553*^9, 
   3.738995480022807*^9},ExpressionUUID->"42e45f75-82e2-49ff-8ae0-\
353905c61f88"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Number of off-diag blocks: \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Number of off-diag blocks: ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.738212431579116*^9, 3.738213367331066*^9, 3.7382233170411797`*^9, 
   3.738470500304206*^9, 3.738471946511137*^9, 3.738476944287079*^9, 
   3.7384824849408207`*^9, {3.738482611752043*^9, 3.738482616254973*^9}, 
   3.738482826736617*^9, 3.738994728536853*^9, 3.7389948263711367`*^9, 
   3.738995094909626*^9, 3.738995294693553*^9, 
   3.7389954800237617`*^9},ExpressionUUID->"5661dce3-12ef-4eeb-987e-\
40d01022ae14"],

Cell[BoxData[
 InterpretationBox["\<\"Dimension of each block  : \
\\!\\(\\*RowBox[{\\\"10\\\"}]\\)\[Times]\\!\\(\\*RowBox[{\\\"10\\\"}]\\)\"\>",
  
  StringForm["Dimension of each block  : ``\[Times]``", 10, 10],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.738212431579116*^9, 3.738213367331066*^9, 3.7382233170411797`*^9, 
   3.738470500304206*^9, 3.738471946511137*^9, 3.738476944287079*^9, 
   3.7384824849408207`*^9, {3.738482611752043*^9, 3.738482616254973*^9}, 
   3.738482826736617*^9, 3.738994728536853*^9, 3.7389948263711367`*^9, 
   3.738995094909626*^9, 3.738995294693553*^9, 
   3.7389954800248127`*^9},ExpressionUUID->"3a5141a2-a4bc-4e6e-aa0a-\
7dcab690b95c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"H", "[", 
   RowBox[{"kx", ",", "ky"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.737972840174588*^9, 
  3.737972859541627*^9}},ExpressionUUID->"7af6273a-dd36-46e8-aff1-\
5b0613164a54"],

Cell[BoxData["60"], "Output",
 CellChangeTimes->{
  3.737972849614469*^9, 3.737972901974722*^9, 3.737973011517962*^9, 
   3.737975877533874*^9, 3.738059255414098*^9, 3.7380595000098886`*^9, 
   3.738121687742161*^9, 3.7382044121043453`*^9, 3.738210355280035*^9, {
   3.73821240698768*^9, 3.7382124317028303`*^9}, 3.7382133712661343`*^9, 
   3.7382139303585367`*^9, 3.738223321484748*^9, 3.7384705005351048`*^9, 
   3.738471946624724*^9, 3.738476944336574*^9, 3.7384824850430393`*^9, {
   3.73848261180405*^9, 3.738482616401224*^9}, 3.738482826954084*^9, 
   3.738994728597272*^9, 3.7389948264233503`*^9, 3.7389950949665422`*^9, 
   3.738995294760332*^9, 
   3.738995480060519*^9},ExpressionUUID->"4fd0d70b-d85b-4ea1-8a26-\
f1b39ad200ae"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Full Velocities", "Section",
 CellChangeTimes->{{3.733393956438672*^9, 
  3.733393964015561*^9}},ExpressionUUID->"248f69a8-6be4-406b-81ff-\
0dcfe8171e14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vx", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "hbar"}], ")"}], 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"x", ",", "ky"}], "]"}], ",", "x"}], "]"}]}], "/.", 
    RowBox[{"x", "\[Rule]", "kx"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vy", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "hbar"}], ")"}], 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"H", "[", 
        RowBox[{"kx", ",", "y"}], "]"}], ",", "y"}], "]"}]}], "/.", 
    RowBox[{"y", "\[Rule]", "ky"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7376919272657547`*^9, 3.737691981254312*^9}, 
   3.737692034023471*^9, {3.737695801764864*^9, 3.737695806523789*^9}, 
   3.7376958727212973`*^9, {3.737870577616332*^9, 
   3.7378705783335943`*^9}},ExpressionUUID->"92c253fa-c064-416a-843a-\
dcf7b8d363a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"vx", "[", 
   RowBox[{"kx", ",", "ky"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.737973129408352*^9, 
  3.737973133076995*^9}},ExpressionUUID->"ae84e743-d0e7-42c9-b79a-\
e8b6972cf6f2"],

Cell[BoxData["60"], "Output",
 CellChangeTimes->{
  3.737973134288402*^9, 3.73797588514835*^9, 3.7380592554538517`*^9, 
   3.738059500056653*^9, 3.738121707670553*^9, 3.738204416012226*^9, 
   3.738210365182756*^9, {3.738212412687931*^9, 3.738212438108585*^9}, 
   3.738213412110259*^9, 3.738223357889292*^9, {3.7384705005754623`*^9, 
   3.738470506959218*^9}, 3.738471946794479*^9, 3.738476944367414*^9, 
   3.738482485124483*^9, {3.738482611848467*^9, 3.7384826164689302`*^9}, 
   3.738482836202907*^9, 3.738994737108923*^9, 3.738994915805375*^9, 
   3.738995099765677*^9, 3.738995298494597*^9, {3.7389954801129303`*^9, 
   3.738995485911718*^9}},ExpressionUUID->"15b569f9-cd95-48dd-bfa0-\
839f3e567bd0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Observables", "Section",
 CellChangeTimes->{{3.71885078054438*^9, 3.718850800680504*^9}, {
  3.720004499585861*^9, 3.720004500505933*^9}, {3.7315720732208557`*^9, 
  3.73157207392972*^9}, {3.7348388440314007`*^9, 
  3.734838846798853*^9}},ExpressionUUID->"f25336d0-c510-435e-a55c-\
18fe9daf6b0c"],

Cell[CellGroupData[{

Cell["Spin Operators", "Subsection",
 CellChangeTimes->{{3.732784490721225*^9, 
  3.732784527361174*^9}},ExpressionUUID->"b75c1901-fbfc-4f89-a9a5-\
2d772497deff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"zero", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"one", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sy", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "I"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"I", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sz", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sxl", "=", 
   RowBox[{"Slab", "[", 
    RowBox[{"5", ",", "sx"}], " ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"syl", "=", 
   RowBox[{"Slab", "[", 
    RowBox[{"5", ",", "sy"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"szl", "=", 
    RowBox[{"Slab", "[", 
     RowBox[{"5", ",", "sz"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sxL", "[", "i", "]"}], "=", " ", 
     RowBox[{"Makeblock", "[", 
      RowBox[{"sxl", ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
       RowBox[{"10", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}]}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"syL", "[", "i", "]"}], "=", " ", 
     RowBox[{"Makeblock", "[", 
      RowBox[{"syl", ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
       RowBox[{"10", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}]}], "]"}]}], ";", "\n", 
    RowBox[{
     RowBox[{"szL", "[", "i", "]"}], "=", " ", 
     RowBox[{"Makeblock", "[", 
      RowBox[{"szl", ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
       RowBox[{"10", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"nbN", "+", "nbF"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.731336639131625*^9, 3.73133663958698*^9}, {
   3.7313371217071743`*^9, 3.731337139435425*^9}, {3.731337178716873*^9, 
   3.73133718484691*^9}, {3.731337371216076*^9, 3.7313373749582443`*^9}, {
   3.731337483809525*^9, 3.7313374882083473`*^9}, {3.7313378633029118`*^9, 
   3.731337876437751*^9}, {3.731339832598715*^9, 3.731339840548748*^9}, {
   3.731340871702538*^9, 3.731340904807557*^9}, {3.7313432641411943`*^9, 
   3.731343264428733*^9}, {3.731347383285926*^9, 3.7313473908156433`*^9}, {
   3.731347789174246*^9, 3.731347827544709*^9}, {3.7313486952053022`*^9, 
   3.731348725077726*^9}, {3.731399092087339*^9, 3.731399104438601*^9}, {
   3.7313991363910217`*^9, 3.731399136598765*^9}, 3.731488548300396*^9, {
   3.736068106022731*^9, 3.736068106166566*^9}, {3.736099875103568*^9, 
   3.7360999030067043`*^9}, {3.736964570917444*^9, 3.736964766377077*^9}, {
   3.7369648177388*^9, 3.736964861882229*^9}, 3.7369649010522127`*^9, {
   3.736968593127121*^9, 3.736968665993222*^9}, {3.736999270781152*^9, 
   3.736999272252885*^9}, {3.737025257017067*^9, 3.737025306617556*^9}, {
   3.737025342761866*^9, 3.737025345703911*^9}, {3.737025384267412*^9, 
   3.737025454983556*^9}, {3.737025520365007*^9, 3.7370256307984343`*^9}, {
   3.737025680832358*^9, 3.737025751041863*^9}, {3.7377007826563683`*^9, 
   3.737700834447941*^9}, {3.737700925182931*^9, 3.737700996740242*^9}, 
   3.7377010350435543`*^9, {3.7377010787746773`*^9, 3.737701082333036*^9}, {
   3.7377077030481787`*^9, 3.73770770980055*^9}, 3.737707751783473*^9, {
   3.737707810564228*^9, 3.7377078143065157`*^9}, {3.737712831427607*^9, 
   3.737712837814865*^9}, {3.737712878439845*^9, 3.737712926370974*^9}, {
   3.7377129929708776`*^9, 3.7377130304246073`*^9}, {3.7377908033955917`*^9, 
   3.737790804762825*^9}, {3.7382233809684896`*^9, 3.738223413763874*^9}, {
   3.738476597518293*^9, 3.738476685424897*^9}, {3.738476749817671*^9, 
   3.7384769014816713`*^9}, {3.738477140659219*^9, 
   3.738477142382406*^9}},ExpressionUUID->"dad80baf-5f99-4b2c-bba7-\
086e01013931"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Projection Operators", "Subsection",
 CellChangeTimes->{{3.738205340232493*^9, 
  3.73820534932927*^9}},ExpressionUUID->"b74ca7e1-efdb-4aa1-adbb-\
351e49e3ada2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"projection", " ", "on", " ", "layer", " ", "i"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pr", "[", "i_", "]"}], ":=", 
     RowBox[{"Makeblock", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "10", "]"}], ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
       RowBox[{"10", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"projection", " ", "on", " ", "spin", " ", "directions"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prsx", "=", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"5", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}], ",", "sx"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"prsy", "=", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"5", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}], ",", "sy"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"prsz", "=", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"5", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}], ",", "sz"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "projection", " ", "on", " ", "spin", " ", "up", " ", "and", " ", 
     "down"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prup", "=", " ", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"5", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prdown", "=", " ", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"5", "*", 
        RowBox[{"(", 
         RowBox[{"nbF", "+", "nbN"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"projection", " ", "on", " ", "orbitals"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prdxy", "=", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"nbF", "+", "nbN"}], ",", 
       RowBox[{"Replblock", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"10", ",", "10"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "1", ",", "1"}], 
        "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"prdzx", "=", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"nbF", "+", "nbN"}], ",", 
       RowBox[{"Replblock", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"10", ",", "10"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "3", ",", "3"}], 
        "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"prdyz", "=", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"nbF", "+", "nbN"}], ",", 
       RowBox[{"Replblock", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"10", ",", "10"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "5", ",", "5"}], 
        "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"prdz2", "=", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"nbF", "+", "nbN"}], ",", 
       RowBox[{"Replblock", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"10", ",", "10"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "7", ",", "7"}], 
        "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"prdx2y2", "=", 
     RowBox[{"Slab", "[", 
      RowBox[{
       RowBox[{"nbF", "+", "nbN"}], ",", 
       RowBox[{"Replblock", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"10", ",", "10"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", "9", ",", "9"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"t2g", " ", "eg", " ", "projection"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prt2g", "=", 
     RowBox[{"prdxy", "+", "prdzx", "+", "prdyz"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"preg", "=", 
     RowBox[{"prdz2", "+", "prdx2y2"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prt2gup", "=", 
     RowBox[{"prup", ".", 
      RowBox[{"(", 
       RowBox[{"prdxy", "+", "prdzx", "+", "prdyz"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prt2gdown", "=", 
     RowBox[{"prdown", ".", 
      RowBox[{"(", 
       RowBox[{"prdxy", "+", "prdzx", "+", "prdyz"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pregup", "=", 
     RowBox[{"prup", ".", 
      RowBox[{"(", 
       RowBox[{"prdz2", "+", "prdx2y2"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pregdown", "=", 
     RowBox[{"prdown", ".", 
      RowBox[{"(", 
       RowBox[{"prdz2", "+", "prdx2y2"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"projection", " ", "on", " ", 
     RowBox[{"ferro", "/", "normal"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prfm", "=", 
     RowBox[{"Replblock", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "*", 
            RowBox[{"(", 
             RowBox[{"nbF", "+", "nbN"}], ")"}]}], ",", 
           RowBox[{"10", "*", 
            RowBox[{"(", 
             RowBox[{"nbF", "+", "nbN"}], ")"}]}]}], "}"}]}], "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"10", "*", "nbF"}], "]"}], ",", "1", ",", "1"}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"prnm", "=", 
     RowBox[{"Replblock", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "*", 
            RowBox[{"(", 
             RowBox[{"nbF", "+", "nbN"}], ")"}]}], ",", 
           RowBox[{"10", "*", 
            RowBox[{"(", 
             RowBox[{"nbF", "+", "nbN"}], ")"}]}]}], "}"}]}], "]"}], ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"10", "*", "nbN"}], "]"}], ",", 
       RowBox[{
        RowBox[{"10", "*", "nbF"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"10", "*", "nbF"}], "+", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prfmup", "=", 
     RowBox[{"prup", ".", "prfm"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prfmdown", "=", 
     RowBox[{"prdown", ".", "prfm"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prnmup", "=", 
     RowBox[{"prup", ".", "prnm"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prnmdown", "=", 
     RowBox[{"prdown", ".", "prnm"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.738204567529132*^9, 3.7382045948570013`*^9}, {
   3.738204630502839*^9, 3.738204670587105*^9}, {3.7382047332252617`*^9, 
   3.738204874880002*^9}, {3.7382052763257637`*^9, 3.738205297827084*^9}, {
   3.738210377228479*^9, 3.738210480664225*^9}, {3.738210539234027*^9, 
   3.738210541117723*^9}, {3.7382134324562273`*^9, 3.738213448210794*^9}, {
   3.738213481745947*^9, 3.73821354977547*^9}, {3.738213611732626*^9, 
   3.738213640216695*^9}, {3.738213724086548*^9, 3.738213793860305*^9}, 
   3.7382236389987307`*^9, {3.738223706484125*^9, 3.738223718057168*^9}, {
   3.7382237583136683`*^9, 3.738223775071063*^9}, {3.738224107303752*^9, 
   3.738224123706875*^9}, 3.738224218660557*^9, {3.738471630977364*^9, 
   3.73847170163521*^9}, {3.7384830630061007`*^9, 
   3.7384830915936213`*^9}},ExpressionUUID->"9e9b5c7c-2ca9-4188-9aca-\
04b2c928645e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin Operators on orbitals", "Subsection",
 CellChangeTimes->{{3.7384772096337547`*^9, 
  3.738477217998426*^9}},ExpressionUUID->"ee1b51f1-1236-4788-94c9-\
024a8ae3a903"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sxorbxy", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdxy", ".", "prsx"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sxorbzx", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdzx", ".", "prsx"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sxorbyz", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdyz", ".", "prsx"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sxorbx2y2", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdx2y2", ".", "prsx"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sxorbz2", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"pr", "[", "i", "]"}], ".", "prdz2", ".", "prsx"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syorbxy", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdxy", ".", "prsy"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syorbzx", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdzx", ".", "prsy"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syorbyz", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdyz", ".", "prsy"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syorbx2y2", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdx2y2", ".", "prsy"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"syorbz2", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pr", "[", "i", "]"}], ".", "prdz2", ".", "prsy"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7384825322884073`*^9, 3.738482545404621*^9}, {
  3.7384831942518044`*^9, 
  3.7384832093881617`*^9}},ExpressionUUID->"9737130a-e12d-4377-be13-\
4b2326683b69"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Susceptibilities by Kubo formula ", "Subsection",
 CellChangeTimes->{{3.732784621394402*^9, 
  3.7327846446265383`*^9}},ExpressionUUID->"6d3272a0-8d69-4cd3-9914-\
b5b1b67e4fc7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Pi", "*", 
    RowBox[{
     RowBox[{"Sqrt", "[", "2", "]"}], "/", "a0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dk", "=", 
   RowBox[{"2", "*", "Pi", "*", 
    RowBox[{
     RowBox[{"Sqrt", "[", "2", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"a0", "*", "n"}], ")"}]}]}]}], ";"}]}], "Input",ExpressionUUID->\
"303efbba-2f5a-46b0-9c4d-bd1a954fd6ad"],

Cell[CellGroupData[{

Cell["for a constant operator", "Subsubsection",
 CellChangeTimes->{{3.738124906269978*^9, 
  3.7381249124256163`*^9}},ExpressionUUID->"2212f727-7192-4b31-9de1-\
aa501ccc5ef5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ISGEr", "[", 
     RowBox[{"A_", ",", "kx_", ",", "ky_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"hbar", "/", 
       RowBox[{"(", 
        RowBox[{"8", "*", 
         RowBox[{"Pi", "^", "3"}]}], ")"}]}], ")"}], 
     RowBox[{"Re", "[", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"vx", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], ".", 
        RowBox[{"Gr", "[", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{"kx", ",", "ky"}], "]"}], ",", "e0", ",", "G"}], "]"}], 
        ".", "A", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ga", "[", 
           RowBox[{
            RowBox[{"H", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], ",", "e0", ",", "G"}], "]"}], 
          "-", 
          RowBox[{"Gr", "[", 
           RowBox[{
            RowBox[{"H", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], ",", "e0", ",", "G"}], "]"}]}],
          ")"}]}], "]"}], "]"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"in", " ", "[", "A", "]"}], "*", 
     RowBox[{"eV", "/", "m"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"[", "A", "]"}], "/", 
     RowBox[{"[", "E", "]"}]}]}], "*)"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ISGE", "[", 
     RowBox[{"A_", ",", "kx_", ",", "ky_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
    RowBox[{"ISGEr", "[", 
     RowBox[{"A", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"kx", "+", "ky"}], ")"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"kx", "-", "ky"}], ")"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "e0", ",", "G"}], "]"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Rotation", " ", "to", " ", "apply", " ", "the", " ", "integration", " ", 
    "on", " ", "a", " ", "square"}], "*)"}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "integration", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntISGE", "[", 
    RowBox[{"A_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ISGE", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], "+", 
               RowBox[{"ISGE", "[", 
                RowBox[{"A", ",", "a", ",", 
                 RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}]}], ")"}], 
             "/", "2"}], "+", 
            RowBox[{"ParallelSum", "[", 
             RowBox[{
              RowBox[{"ISGE", "[", 
               RowBox[{"A", ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"u", "*", "dk"}]}], ",", 
                RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
          "dk"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"ISGE", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"-", "a"}], ",", "a", ",", "e0", ",", "G"}], "]"}], 
               "+", 
               RowBox[{"ISGE", "[", 
                RowBox[{"A", ",", "a", ",", "a", ",", "e0", ",", "G"}], 
                "]"}]}], ")"}], "/", "2"}], "+", 
            RowBox[{"ParallelSum", "[", 
             RowBox[{
              RowBox[{"ISGE", "[", 
               RowBox[{"A", ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"u", "*", "dk"}]}], ",", "a", ",", "e0", ",", "G"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
          "dk"}]}], ")"}], "/", "2"}], "+", "\[IndentingNewLine]", 
      RowBox[{"ParallelSum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ISGE", "[", 
               RowBox[{"A", ",", 
                RowBox[{"-", "a"}], ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], 
              "+", 
              RowBox[{"ISGE", "[", 
               RowBox[{"A", ",", "a", ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}]}], 
             ")"}], "/", "2"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"ISGE", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{"-", "a"}], "+", 
                RowBox[{"u", "*", "dk"}]}], ",", 
               RowBox[{
                RowBox[{"-", "a"}], "+", 
                RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"u", ",", "1", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
         "dk"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", "dk"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.73235327708473*^9, 3.732353299415937*^9}, {
   3.732783228262083*^9, 3.732783300981431*^9}, {3.732783335279676*^9, 
   3.732783406894916*^9}, {3.732783461034917*^9, 3.73278354033595*^9}, {
   3.732783601308345*^9, 3.732783680340007*^9}, {3.7327837413386097`*^9, 
   3.732783814830976*^9}, {3.732783862318205*^9, 3.732783969089919*^9}, {
   3.732784059261992*^9, 3.732784061389889*^9}, {3.732784098102511*^9, 
   3.732784099766177*^9}, {3.732784189033252*^9, 3.732784197809758*^9}, {
   3.732784402394183*^9, 3.73278448788133*^9}, 3.732784582603221*^9, 
   3.7327846154343843`*^9, {3.732785830204876*^9, 3.7327858646810303`*^9}, {
   3.732785916481698*^9, 3.732785948553956*^9}, {3.732786175204582*^9, 
   3.732786185540766*^9}, {3.732786222493238*^9, 3.732786294215014*^9}, {
   3.73294013548059*^9, 3.732940267692425*^9}, {3.732940301820731*^9, 
   3.7329403445314703`*^9}, {3.7329569814817257`*^9, 3.732956982375204*^9}, {
   3.733050602245682*^9, 3.733050688687932*^9}, {3.733457792561171*^9, 
   3.733457904243269*^9}, {3.7342600639629793`*^9, 3.7342601725225573`*^9}, {
   3.7342609663833923`*^9, 3.734260967755678*^9}, {3.734319875803664*^9, 
   3.734319890181623*^9}, {3.7343204619638844`*^9, 3.734320570699524*^9}, {
   3.734425317289797*^9, 3.7344253413936653`*^9}, {3.73442538919606*^9, 
   3.734425536769515*^9}, 3.7344276961507683`*^9, {3.734774150376706*^9, 
   3.734774162058166*^9}, {3.7377061706918507`*^9, 3.737706206739707*^9}, {
   3.737870655452775*^9, 3.73787068674584*^9}, {3.7378712322078543`*^9, 
   3.7378712632410717`*^9}, {3.73787138867382*^9, 3.737871401546664*^9}, {
   3.737871528206936*^9, 3.737871724296927*^9}, {3.7378717746717863`*^9, 
   3.737871874837968*^9}, {3.737872669598935*^9, 3.737872686878085*^9}, {
   3.737966919952714*^9, 3.737966953347581*^9}, {3.7379675372794523`*^9, 
   3.737967545560823*^9}, {3.7379679571323643`*^9, 3.737967960275633*^9}, {
   3.737968032045157*^9, 3.73796804939809*^9}, {3.737968099069365*^9, 
   3.737968133821094*^9}, {3.7381210404157667`*^9, 3.738121247440543*^9}, {
   3.738121310124443*^9, 3.738121352714776*^9}, {3.738121386794609*^9, 
   3.7381214612982483`*^9}, {3.738121612056563*^9, 3.7381216145071983`*^9}, 
   3.738121671308834*^9, {3.7381247511019163`*^9, 3.738124788412517*^9}, {
   3.738124893593102*^9, 3.738124924691985*^9}, {3.738125257879178*^9, 
   3.738125268581503*^9}},ExpressionUUID->"2e856dea-7944-4b24-b60b-\
0b93dbf37122"]
}, Closed]],

Cell[CellGroupData[{

Cell["for conductivity", "Subsubsection",
 CellChangeTimes->{{3.73235327708473*^9, 3.732353299415937*^9}, {
   3.732783228262083*^9, 3.732783300981431*^9}, {3.732783335279676*^9, 
   3.732783406894916*^9}, {3.732783461034917*^9, 3.73278354033595*^9}, {
   3.732783601308345*^9, 3.732783680340007*^9}, {3.7327837413386097`*^9, 
   3.732783814830976*^9}, {3.732783862318205*^9, 3.732783969089919*^9}, {
   3.732784059261992*^9, 3.732784061389889*^9}, {3.732784098102511*^9, 
   3.732784099766177*^9}, {3.732784189033252*^9, 3.732784197809758*^9}, {
   3.732784402394183*^9, 3.73278448788133*^9}, 3.732784582603221*^9, 
   3.7327846154343843`*^9, {3.732785830204876*^9, 3.7327858646810303`*^9}, {
   3.732785916481698*^9, 3.732785948553956*^9}, {3.732786175204582*^9, 
   3.732786185540766*^9}, {3.732786222493238*^9, 3.732786294215014*^9}, {
   3.73294013548059*^9, 3.732940267692425*^9}, {3.732940301820731*^9, 
   3.7329403445314703`*^9}, {3.7329569814817257`*^9, 3.732956982375204*^9}, {
   3.733050602245682*^9, 3.733050688687932*^9}, {3.733457792561171*^9, 
   3.733457904243269*^9}, {3.7342600639629793`*^9, 3.7342601725225573`*^9}, {
   3.7342609663833923`*^9, 3.734260967755678*^9}, {3.734319875803664*^9, 
   3.734319890181623*^9}, {3.7343204619638844`*^9, 3.734320570699524*^9}, {
   3.734425317289797*^9, 3.7344253413936653`*^9}, {3.73442538919606*^9, 
   3.734425536769515*^9}, 3.7344276961507683`*^9, {3.734774150376706*^9, 
   3.734774162058166*^9}, {3.7377061706918507`*^9, 3.737706206739707*^9}, {
   3.737870655452775*^9, 3.73787068674584*^9}, {3.7378712322078543`*^9, 
   3.7378712632410717`*^9}, {3.73787138867382*^9, 3.737871401546664*^9}, {
   3.737871528206936*^9, 3.737871724296927*^9}, {3.7378717746717863`*^9, 
   3.737871874837968*^9}, {3.737872669598935*^9, 3.737872686878085*^9}, {
   3.737966919952714*^9, 3.737966953347581*^9}, {3.7379675372794523`*^9, 
   3.737967545560823*^9}, {3.7379679571323643`*^9, 3.737967960275633*^9}, {
   3.737968032045157*^9, 3.73796804939809*^9}, {3.737968099069365*^9, 
   3.737968133821094*^9}, {3.7381210404157667`*^9, 3.738121247440543*^9}, {
   3.738121310124443*^9, 3.738121352714776*^9}, {3.738121386794609*^9, 
   3.7381214612982483`*^9}, {3.738121612056563*^9, 3.7381216145071983`*^9}, 
   3.738121671308834*^9, {3.7381223206401176`*^9, 3.7381223654744673`*^9}, 
   3.738122516767507*^9, {3.738124817381774*^9, 
   3.738124846911193*^9}},ExpressionUUID->"2e856dea-7944-4b24-b60b-\
0b93dbf37122"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Cxxr", "[", 
      RowBox[{"kx_", ",", "ky_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ehbar", "/", 
        RowBox[{"(", 
         RowBox[{"8", "*", 
          RowBox[{"Pi", "^", "3"}]}], ")"}]}], ")"}], 
      RowBox[{"Re", "[", 
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ".", 
         RowBox[{"Gr", "[", 
          RowBox[{"kx", ",", "ky", ",", "e0", ",", "G"}], "]"}], ".", 
         RowBox[{"vx", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ga", "[", 
            RowBox[{"kx", ",", "ky", ",", "e0", ",", "G"}], "]"}], "-", 
           RowBox[{"Gr", "[", 
            RowBox[{"kx", ",", "ky", ",", "e0", ",", "G"}], "]"}]}], ")"}]}], 
        "]"}], "]"}]}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"conductivity", " ", "along", " ", "x", " ", "in", " ", 
     RowBox[{"1", "/", "Ohm"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cxx", "[", 
      RowBox[{"kx_", ",", "ky_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
     RowBox[{"Cxxr", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "e0", ",", "G"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cxyr", "[", 
      RowBox[{"kx_", ",", "ky_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ehbar", "/", 
        RowBox[{"(", 
         RowBox[{"8", "*", 
          RowBox[{"Pi", "^", "3"}]}], ")"}]}], ")"}], 
      RowBox[{"Re", "[", 
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"vx", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ".", 
         RowBox[{"Gr", "[", 
          RowBox[{"kx", ",", "ky", ",", "e0", ",", "G"}], "]"}], ".", 
         RowBox[{"vy", "[", 
          RowBox[{"kx", ",", "ky"}], "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ga", "[", 
            RowBox[{"kx", ",", "ky", ",", "e0", ",", "G"}], "]"}], "-", 
           RowBox[{"Gr", "[", 
            RowBox[{"kx", ",", "ky", ",", "e0", ",", "G"}], "]"}]}], ")"}]}], 
        "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Cxy", "[", 
      RowBox[{"kx_", ",", "ky_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
     RowBox[{"Cxyr", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "+", "ky"}], ")"}], "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"kx", "-", "ky"}], ")"}], "/", 
        RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "e0", ",", "G"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"in", " ", "[", 
       RowBox[{"ISGE", "[", "A", "]"}], "]"}], "/", 
      RowBox[{"m", "^", "2"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"[", "A", "]"}], "/", 
       RowBox[{"[", "E", "]"}]}], "/", 
      RowBox[{"m", "^", "2"}]}]}], "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntCxx", "[", 
      RowBox[{"e0_", ",", "G_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cxx", "[", 
                  RowBox[{
                   RowBox[{"-", "a"}], ",", 
                   RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], "+", 
                 RowBox[{"Cxx", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}]}], ")"}], 
               "/", "2"}], "+", 
              RowBox[{"ParallelSum", "[", 
               RowBox[{
                RowBox[{"Cxx", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "a"}], "+", 
                   RowBox[{"u", "*", "dk"}]}], ",", 
                  RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"u", ",", "1", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
            "dk"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cxx", "[", 
                  RowBox[{
                   RowBox[{"-", "a"}], ",", "a", ",", "e0", ",", "G"}], "]"}],
                  "+", 
                 RowBox[{"Cxx", "[", 
                  RowBox[{"a", ",", "a", ",", "e0", ",", "G"}], "]"}]}], 
                ")"}], "/", "2"}], "+", 
              RowBox[{"ParallelSum", "[", 
               RowBox[{
                RowBox[{"Cxx", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "a"}], "+", 
                   RowBox[{"u", "*", "dk"}]}], ",", "a", ",", "e0", ",", 
                  "G"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"u", ",", "1", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
            "dk"}]}], ")"}], "/", "2"}], "+", "\[IndentingNewLine]", 
        RowBox[{"ParallelSum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cxx", "[", 
                 RowBox[{
                  RowBox[{"-", "a"}], ",", 
                  RowBox[{
                   RowBox[{"-", "a"}], "+", 
                   RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], 
                "+", 
                RowBox[{"Cxx", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{
                   RowBox[{"-", "a"}], "+", 
                   RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}]}],
                ")"}], "/", "2"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"Cxx", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "a"}], "+", 
                  RowBox[{"u", "*", "dk"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", "a"}], "+", 
                  RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"u", ",", "1", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
           "dk"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", "1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", "dk"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntCxy", "[", 
      RowBox[{"e0_", ",", "G_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cxy", "[", 
                  RowBox[{
                   RowBox[{"-", "a"}], ",", 
                   RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], "+", 
                 RowBox[{"Cxy", "[", 
                  RowBox[{"a", ",", 
                   RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}]}], ")"}], 
               "/", "2"}], "+", 
              RowBox[{"ParallelSum", "[", 
               RowBox[{
                RowBox[{"Cxy", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "a"}], "+", 
                   RowBox[{"u", "*", "dk"}]}], ",", 
                  RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"u", ",", "1", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
            "dk"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Cxy", "[", 
                  RowBox[{
                   RowBox[{"-", "a"}], ",", "a", ",", "e0", ",", "G"}], "]"}],
                  "+", 
                 RowBox[{"Cxy", "[", 
                  RowBox[{"a", ",", "a", ",", "e0", ",", "G"}], "]"}]}], 
                ")"}], "/", "2"}], "+", 
              RowBox[{"ParallelSum", "[", 
               RowBox[{
                RowBox[{"Cxy", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "a"}], "+", 
                   RowBox[{"u", "*", "dk"}]}], ",", "a", ",", "e0", ",", 
                  "G"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"u", ",", "1", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
            "dk"}]}], ")"}], "/", "2"}], "+", "\[IndentingNewLine]", 
        RowBox[{"ParallelSum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cxy", "[", 
                 RowBox[{
                  RowBox[{"-", "a"}], ",", 
                  RowBox[{
                   RowBox[{"-", "a"}], "+", 
                   RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], 
                "+", 
                RowBox[{"Cxy", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{
                   RowBox[{"-", "a"}], "+", 
                   RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}]}],
                ")"}], "/", "2"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"Cxy", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "a"}], "+", 
                  RowBox[{"u", "*", "dk"}]}], ",", 
                 RowBox[{
                  RowBox[{"-", "a"}], "+", 
                  RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"u", ",", "1", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
           "dk"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", "1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", "dk"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Conductivity", " ", "along", " ", "y", " ", "in", " ", 
     RowBox[{"1", "/", "Ohm"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "the", " ", "Kubo", " ", "formula", " ", "with", 
     " ", "respect", " ", "to", " ", "an", " ", "electric", " ", "field", " ", 
     RowBox[{"perturbation", ".", " ", "This"}], " ", "is", " ", "encoded", 
     " ", "through", " ", "the", " ", "presence", " ", "of", " ", "the", " ", 
     "operator", " ", "vx"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "perturbation", " ", "was", " ", "a", " ", 
      "magnetic", " ", "field"}], ",", " ", 
     RowBox[{
     "the", " ", "operator", " ", "vx", " ", "would", " ", "be", " ", 
      "replaced", " ", "by", " ", "a", " ", "spin", " ", "operator"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Only", " ", "intraband", " ", "term", " ", "is", " ", "written"}], ",", 
     " ", 
     RowBox[{"we", " ", "neglect", " ", "topological", " ", "effects", " ", 
      RowBox[{"(", 
       RowBox[{
       "we", " ", "neglect", " ", "the", " ", "interband", " ", 
        "contribution", " ", "to", " ", "the", " ", "Kubo", " ", "formula"}], 
       " ", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Integration", " ", "is", " ", "made", " ", "on", " ", "the", " ", 
      "Brillouin", " ", "zone"}], ",", " ", 
     RowBox[{"realizing", " ", "a", " ", "Fourier", " ", "Transform"}], ",", 
     " ", 
     RowBox[{
     "is", " ", "n", " ", "standing", " ", "for", " ", "the", " ", "number", 
      " ", "of", " ", 
      RowBox[{"atoms", "?"}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.73235327708473*^9, 3.732353299415937*^9}, {
   3.732783228262083*^9, 3.732783300981431*^9}, {3.732783335279676*^9, 
   3.732783406894916*^9}, {3.732783461034917*^9, 3.73278354033595*^9}, {
   3.732783601308345*^9, 3.732783680340007*^9}, {3.7327837413386097`*^9, 
   3.732783814830976*^9}, {3.732783862318205*^9, 3.732783969089919*^9}, {
   3.732784059261992*^9, 3.732784061389889*^9}, {3.732784098102511*^9, 
   3.732784099766177*^9}, {3.732784189033252*^9, 3.732784197809758*^9}, {
   3.732784402394183*^9, 3.73278448788133*^9}, 3.732784582603221*^9, 
   3.7327846154343843`*^9, {3.732785830204876*^9, 3.7327858646810303`*^9}, {
   3.732785916481698*^9, 3.732785948553956*^9}, {3.732786175204582*^9, 
   3.732786185540766*^9}, {3.732786222493238*^9, 3.732786294215014*^9}, {
   3.73294013548059*^9, 3.732940267692425*^9}, {3.732940301820731*^9, 
   3.7329403445314703`*^9}, {3.7329569814817257`*^9, 3.732956982375204*^9}, {
   3.733050602245682*^9, 3.733050688687932*^9}, {3.733457792561171*^9, 
   3.733457904243269*^9}, {3.7342600639629793`*^9, 3.7342601725225573`*^9}, {
   3.7342609663833923`*^9, 3.734260967755678*^9}, {3.734319875803664*^9, 
   3.734319890181623*^9}, {3.7343204619638844`*^9, 3.734320570699524*^9}, {
   3.734425317289797*^9, 3.7344253413936653`*^9}, {3.73442538919606*^9, 
   3.734425536769515*^9}, 3.7344276961507683`*^9, {3.734774150376706*^9, 
   3.734774162058166*^9}, {3.7377061706918507`*^9, 3.737706206739707*^9}, {
   3.737870655452775*^9, 3.73787068674584*^9}, {3.7378712322078543`*^9, 
   3.7378712632410717`*^9}, {3.73787138867382*^9, 3.737871401546664*^9}, {
   3.737871528206936*^9, 3.737871724296927*^9}, {3.7378717746717863`*^9, 
   3.737871874837968*^9}, {3.737872669598935*^9, 3.737872686878085*^9}, {
   3.737966919952714*^9, 3.737966953347581*^9}, {3.7379675372794523`*^9, 
   3.737967545560823*^9}, {3.7379679571323643`*^9, 3.737967960275633*^9}, {
   3.737968032045157*^9, 3.73796804939809*^9}, {3.737968099069365*^9, 
   3.737968133821094*^9}, {3.7381210404157667`*^9, 3.738121247440543*^9}, {
   3.738121310124443*^9, 3.738121352714776*^9}, {3.738121386794609*^9, 
   3.7381214612982483`*^9}, {3.738121612056563*^9, 3.7381216145071983`*^9}, 
   3.738121671308834*^9, {3.7381223206401176`*^9, 3.7381223654744673`*^9}, 
   3.738122516767507*^9, {3.738124817381774*^9, 3.738124835693573*^9}, {
   3.738124955747611*^9, 3.73812496422729*^9}, {3.7381250754235573`*^9, 
   3.73812510739675*^9}, {3.738125175400126*^9, 3.7381252505080223`*^9}, {
   3.7381254204991426`*^9, 
   3.738125490585731*^9}},ExpressionUUID->"2e856dea-7944-4b24-b60b-\
0b93dbf37122"]
}, Closed]],

Cell[CellGroupData[{

Cell["for density of states", "Subsubsection",
 CellChangeTimes->{{3.734838809879752*^9, 3.734838825799992*^9}, {
  3.738125283365077*^9, 
  3.7381252855406847`*^9}},ExpressionUUID->"664f795f-f0fe-4588-a093-\
fdeb83a87e0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "matrices", " ", "of", " ", "the", " ", "same", " ", "dimension", " ", 
    "as", " ", "Heff", " ", "and", " ", "with", " ", "zeros", " ", 
    "everywhere", " ", "except", " ", "at", " ", 
    RowBox[{"(", 
     RowBox[{"i", ",", "j"}], ")"}], " ", "position"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TotalDOS", "[", 
      RowBox[{"u_", ",", "v_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"1", "/", "Pi"}], ")"}]}], "*", 
      RowBox[{"Im", "[", 
       RowBox[{"Tr", "[", 
        RowBox[{"Gr", "[", 
         RowBox[{
          RowBox[{"H", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"u", "+", "v"}], ")"}], "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"u", "-", "v"}], ")"}], "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}], ",", "e0", ",", 
          "G"}], "]"}], "]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DOS", "[", 
      RowBox[{"pr_", ",", "u_", ",", "v_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"1", "/", "Pi"}], ")"}]}], "*", 
      RowBox[{"Im", "[", 
       RowBox[{"Tr", "[", 
        RowBox[{"pr", ".", 
         RowBox[{"Gr", "[", 
          RowBox[{
           RowBox[{"H", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}], "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"u", "-", "v"}], ")"}], "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}], ",", "e0", ",", 
           "G"}], "]"}]}], "]"}], "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.7377073988634243`*^9, {3.737870591010344*^9, 3.737870640767007*^9}, {
   3.737870939834196*^9, 3.7378709796541653`*^9}, {3.737871019400427*^9, 
   3.7378710266228037`*^9}, {3.737871357016239*^9, 3.737871369596973*^9}, 
   3.737871951133522*^9, {3.737872063494197*^9, 3.737872127049919*^9}, {
   3.737872245488699*^9, 3.7378722483346567`*^9}, 3.737872352810604*^9, {
   3.737872389035346*^9, 3.737872396504787*^9}, {3.738125335829567*^9, 
   3.7381253896911592`*^9}, {3.738125524585558*^9, 3.738125531272484*^9}, 
   3.7382108050740137`*^9},ExpressionUUID->"261675b4-c4c7-485a-bd89-\
71047af4f1d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntDOS", "[", 
    RowBox[{"pr_", ",", "e0_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"4", "*", 
        RowBox[{"Pi", "^", "2"}]}], ")"}]}], ")"}], "*", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"DOS", "[", 
                RowBox[{"pr", ",", 
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], "+", 
               RowBox[{"DOS", "[", 
                RowBox[{"pr", ",", "a", ",", 
                 RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}]}], ")"}], 
             "/", "2"}], "+", 
            RowBox[{"ParallelSum", "[", 
             RowBox[{
              RowBox[{"DOS", "[", 
               RowBox[{"pr", ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"u", "*", "dk"}]}], ",", 
                RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
          "dk"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"DOS", "[", 
                RowBox[{"pr", ",", 
                 RowBox[{"-", "a"}], ",", "a", ",", "e0", ",", "G"}], "]"}], 
               "+", 
               RowBox[{"DOS", "[", 
                RowBox[{"pr", ",", "a", ",", "a", ",", "e0", ",", "G"}], 
                "]"}]}], ")"}], "/", "2"}], "+", 
            RowBox[{"ParallelSum", "[", 
             RowBox[{
              RowBox[{"DOS", "[", 
               RowBox[{"pr", ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"u", "*", "dk"}]}], ",", "a", ",", "e0", ",", "G"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
          "dk"}]}], ")"}], "/", "2"}], "+", "\[IndentingNewLine]", 
      RowBox[{"ParallelSum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DOS", "[", 
               RowBox[{"pr", ",", 
                RowBox[{"-", "a"}], ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], 
              "+", 
              RowBox[{"DOS", "[", 
               RowBox[{"pr", ",", "a", ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}]}], 
             ")"}], "/", "2"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"DOS", "[", 
              RowBox[{"pr", ",", 
               RowBox[{
                RowBox[{"-", "a"}], "+", 
                RowBox[{"u", "*", "dk"}]}], ",", 
               RowBox[{
                RowBox[{"-", "a"}], "+", 
                RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"u", ",", "1", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
         "dk"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", "dk"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.73812574350592*^9, 3.73812575547364*^9}, {
  3.738125847551868*^9, 
  3.738125894481181*^9}},ExpressionUUID->"210c5719-d24b-4b2d-9777-\
1b3fb8a60efe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"IntTotalDOS", "[", 
    RowBox[{"e0_", ",", "G_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"4", "*", 
        RowBox[{"Pi", "^", "2"}]}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TotalDOS", "[", 
                RowBox[{
                 RowBox[{"-", "a"}], ",", 
                 RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], "+", 
               RowBox[{"DOS", "[", 
                RowBox[{"pr", ",", "a", ",", 
                 RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}]}], ")"}], 
             "/", "2"}], "+", 
            RowBox[{"ParallelSum", "[", 
             RowBox[{
              RowBox[{"TotalDOS", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"u", "*", "dk"}]}], ",", 
                RowBox[{"-", "a"}], ",", "e0", ",", "G"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
          "dk"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TotalDOS", "[", 
                RowBox[{
                 RowBox[{"-", "a"}], ",", "a", ",", "e0", ",", "G"}], "]"}], 
               "+", 
               RowBox[{"TotalDOS", "[", 
                RowBox[{"a", ",", "a", ",", "e0", ",", "G"}], "]"}]}], ")"}], 
             "/", "2"}], "+", 
            RowBox[{"ParallelSum", "[", 
             RowBox[{
              RowBox[{"TotalDOS", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"u", "*", "dk"}]}], ",", "a", ",", "e0", ",", "G"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
          "dk"}]}], ")"}], "/", "2"}], "+", "\[IndentingNewLine]", 
      RowBox[{"ParallelSum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TotalDOS", "[", 
               RowBox[{
                RowBox[{"-", "a"}], ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], 
              "+", 
              RowBox[{"TotalDOS", "[", 
               RowBox[{"a", ",", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", 
                 RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}]}], 
             ")"}], "/", "2"}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"TotalDOS", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "a"}], "+", 
                RowBox[{"u", "*", "dk"}]}], ",", 
               RowBox[{
                RowBox[{"-", "a"}], "+", 
                RowBox[{"v", "*", "dk"}]}], ",", "e0", ",", "G"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"u", ",", "1", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", 
         "dk"}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}], "*", "dk"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.73235327708473*^9, 3.732353299415937*^9}, {
   3.732783228262083*^9, 3.732783300981431*^9}, {3.732783335279676*^9, 
   3.732783406894916*^9}, {3.732783461034917*^9, 3.73278354033595*^9}, {
   3.732783601308345*^9, 3.732783680340007*^9}, {3.7327837413386097`*^9, 
   3.732783814830976*^9}, {3.732783862318205*^9, 3.732783969089919*^9}, {
   3.732784059261992*^9, 3.732784061389889*^9}, {3.732784098102511*^9, 
   3.732784099766177*^9}, {3.732784189033252*^9, 3.732784197809758*^9}, {
   3.732784402394183*^9, 3.73278448788133*^9}, 3.732784582603221*^9, 
   3.7327846154343843`*^9, {3.7348388718331423`*^9, 3.734839006319654*^9}, {
   3.734839498389083*^9, 3.734839507720686*^9}, {3.7358818121280622`*^9, 
   3.735881833953986*^9}, {3.737625986813608*^9, 3.737625993799617*^9}, {
   3.7376904344234533`*^9, 3.737690444763571*^9}, {3.7376905377901897`*^9, 
   3.737690601540657*^9}, {3.7378706457570763`*^9, 3.73787064828132*^9}, {
   3.73787137462923*^9, 3.737871380076109*^9}, {3.737872399793584*^9, 
   3.737872492745673*^9}, {3.737974257434424*^9, 3.7379742770407476`*^9}, {
   3.738125908137649*^9, 
   3.738125959101212*^9}},ExpressionUUID->"4969f42a-5510-4c07-82a6-\
e74817ea2f9f"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Section",
 CellChangeTimes->{{3.737086745817171*^9, 
  3.737086747645273*^9}},ExpressionUUID->"c7706e92-2b2f-4b8f-adb7-\
56874a6727be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sxdxy", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"sxorbxy", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sxdzx", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"sxorbzx", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sxdyz", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"sxorbyz", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sxdz2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"sxorbz2", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sxdx2y2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"sxorbx2y2", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7384778678320723`*^9, 3.7384778759066553`*^9}, {
  3.738483282415996*^9, 3.738483438157022*^9}, {3.73848347057015*^9, 
  3.738483480310987*^9}, {3.738483726001614*^9, 
  3.73848372611167*^9}},ExpressionUUID->"bea1cffb-a406-4b0a-bf7b-\
7210894eecac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdxy.dat\>\"", ",", 
    "sxdxy"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdzx.dat\>\"", ",", 
    "sxdzx"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdyz.dat\>\"", ",", 
    "sxdyz"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdz2.dat\>\"", ",", 
    "sxdz2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdx2y2.dat\>\"", ",", 
    "sxdx2y2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.73847802536452*^9, 3.73847813267443*^9}, {
  3.738481835982913*^9, 3.738481846482315*^9}, {3.739000621550239*^9, 
  3.739000625805773*^9}},ExpressionUUID->"9013b48b-57ad-4077-8465-\
2e55a729a61b"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdxy.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.738998733892909*^9},ExpressionUUID->"96ec41c0-ac2b-4ab6-881a-\
e3a487e90462"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdzx.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.738998733896069*^9},ExpressionUUID->"cebc6aec-6781-41d1-b4c6-\
1ac084d3b51c"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdyz.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.738998733903413*^9},ExpressionUUID->"008ee5ef-1bee-4953-8636-\
871fd2e7863c"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdz2.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.738998733905336*^9},ExpressionUUID->"25041793-2e15-4fb3-926a-\
42d04233717a"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sxdx2y2.dat\"\>\
"], "Output",
 CellChangeTimes->{
  3.7389987339072857`*^9},ExpressionUUID->"5ea0e017-3145-48e3-82ae-\
11eb1bb9f1c4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sydxy", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"syorbxy", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sydzx", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"syorbzx", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sydyz", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"syorbyz", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sydz2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"syorbz2", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sydx2y2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"IntISGE", "[", 
        RowBox[{
         RowBox[{"syorbx2y2", "[", "i", "]"}], ",", "Ef", ",", "G"}], "]"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.738476496672385*^9, 3.7384765036947947`*^9}, {
  3.738476535534184*^9, 3.7384765406959457`*^9}, {3.738477610473301*^9, 
  3.738477679576416*^9}, {3.73847783541917*^9, 3.7384778602465563`*^9}, {
  3.738483486029435*^9, 3.738483505795232*^9}, {3.7384837292677917`*^9, 
  3.738483729437622*^9}},ExpressionUUID->"b5c2f147-a7b1-4a60-bd81-\
677f7d195995"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydxy.dat\>\"", ",", 
    "sydxy"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydzx.dat\>\"", ",", 
    "sydzx"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydyz.dat\>\"", ",", 
    "sydyz"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydz2.dat\>\"", ",", 
    "sydz2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydx2y2.dat\>\"", ",", 
    "sydx2y2"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.738478141416071*^9, 3.738478157138812*^9}, {
  3.73848185193968*^9, 3.738481856694314*^9}, {3.739001895079194*^9, 
  3.739001897108809*^9}},ExpressionUUID->"f2e52a56-289a-4012-ab36-\
6ef58e0c5f99"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydxy.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.739001883828315*^9},ExpressionUUID->"98b4e3cd-a537-4ed5-b789-\
f19487258b53"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydzx.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.7390018838296347`*^9},ExpressionUUID->"ee3c1af1-2239-43d4-a54e-\
72af1f9eb43a"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydyz.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.739001883830969*^9},ExpressionUUID->"96700c91-6d1e-4e3a-8d02-\
2246d8fc5fed"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydz2.dat\"\>"]\
, "Output",
 CellChangeTimes->{
  3.739001883832301*^9},ExpressionUUID->"76a510cb-703a-464f-a042-\
d880e767c2b1"],

Cell[BoxData["\<\"~/Desktop/mathematica/data/5_orbitals/3Fe_3W/sydx2y2.dat\"\>\
"], "Output",
 CellChangeTimes->{
  3.739001883836254*^9},ExpressionUUID->"4f107ad4-a808-4971-982f-\
55a2907b81fe"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Questions ", "Section",
 CellChangeTimes->{{3.7389872780326653`*^9, 
  3.7389873094317913`*^9}},ExpressionUUID->"e768cc05-5418-4c64-8805-\
945bae3ed9c5"],

Cell[CellGroupData[{

Cell["General Questions ", "Subsection",
 CellChangeTimes->{{3.738987454938588*^9, 
  3.738987461521372*^9}},ExpressionUUID->"e2d59b8f-f17b-4396-9aae-\
19ccda969fdd"],

Cell["\<\
1- why we are only considering the d orbitals although the hopping parameters \
are comparable ? 
2- why we neglect the three-centre approximation?
3- different spins have different parameters but we didn\[CloseCurlyQuote]t \
consider that ?!\
\>", "Text",
 CellChangeTimes->{{3.738987311506328*^9, 3.73898742228111*^9}, {
   3.738987893950591*^9, 3.7389878940785217`*^9}, 
   3.7390915133950157`*^9},ExpressionUUID->"9eb2d9ee-d05d-424b-b30b-\
85dbeadd346d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters ", "Subsection",
 CellChangeTimes->{{3.738987542547819*^9, 
  3.738987556650559*^9}},ExpressionUUID->"1d1ce248-89a2-4c32-be81-\
31eae1abbeca"],

Cell[TextData[{
 "1- why different values for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f61abbb4-cb2f-4120-aaa0-984230c8ed7d"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["x", "2"], "-", 
     SuperscriptBox["y", "2"]}], ",", " ", 
    SuperscriptBox["z", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0569a00f-b1d4-446d-afb0-1f92bc897df3"],
 " \n2- the value of J ??!\n5- ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"0", " "}]], "=", 
    RowBox[{"??", " "}]}], TraditionalForm]],ExpressionUUID->
  "7a1fbbcf-fafe-460d-9d38-9f21eec7bb42"],
 "can we have different ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", 
    RowBox[{"0", " "}]], TraditionalForm]],ExpressionUUID->
  "69937f8d-b32e-4fa0-951c-3acb57af8203"],
 "since we have different environments ??\n6- why there is no hopping between \
states with different hopping ??\n7- Theta is along z-axis. does that \
actually matters ?\n8- extra h-bar in the SOC ??! \n\n**rearrange the \
questions"
}], "Text",
 CellChangeTimes->{{3.738987614516447*^9, 3.7389876150912857`*^9}, {
  3.7389879479993687`*^9, 3.738988020808079*^9}, {3.738988348844969*^9, 
  3.738988382492161*^9}, {3.738988458390335*^9, 3.738988509382065*^9}, {
  3.73898861059916*^9, 3.738988646967353*^9}, {3.73899184704574*^9, 
  3.7389918726159477`*^9}, {3.738993254732946*^9, 3.73899327496517*^9}, {
  3.7390148664363213`*^9, 3.739014910213044*^9}, {3.739023430886877*^9, 
  3.7390234474299088`*^9}, {3.7390914805941553`*^9, 3.739091483120851*^9}, {
  3.7390915215066442`*^9, 3.739091573905836*^9}, {3.739091645546721*^9, 
  3.7390916554268847`*^9}, {3.739094971602787*^9, 3.739094974136936*^9}, {
  3.7391016500367393`*^9, 3.739101672787816*^9}, {3.739102296228025*^9, 
  3.73910232241122*^9}},ExpressionUUID->"6c10989b-8fd1-4bc2-870b-\
d3c895ff898a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["S-K parameters ", "Subsection",
 CellChangeTimes->{{3.738987640780898*^9, 
  3.738987653563465*^9}},ExpressionUUID->"a47d550a-be46-4b04-bff4-\
ae447cc6c4db"],

Cell["1- why there is -i and does that actually matters ?", "Text",
 CellChangeTimes->{{3.738987780294235*^9, 3.738987782245316*^9}, {
  3.739022241546151*^9, 
  3.739022273361498*^9}},ExpressionUUID->"ca6ee763-3873-4df8-9c99-\
517620baee8c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{907, 894},
WindowMargins->{{Automatic, 279}, {86, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 276, 6, 322, "Title", "ExpressionUUID" -> \
"9af2dee5-d204-4922-9712-36c794d0b96b"],
Cell[CellGroupData[{
Cell[723, 25, 150, 3, 40, "Input", "ExpressionUUID" -> \
"5b8d71db-a909-4b56-8c7d-611e20f79511"],
Cell[CellGroupData[{
Cell[898, 32, 46917, 1242, 240, "Print", "ExpressionUUID" -> \
"26a3a53b-9633-449a-936c-f47e193be4a7"],
Cell[47818, 1276, 560, 8, 173, "Print", "ExpressionUUID" -> \
"8419d838-6340-485c-b121-0ae94abe967a"],
Cell[48381, 1286, 694, 10, 221, "Print", "ExpressionUUID" -> \
"48560553-b44c-411c-a7da-ec6bcb7fd268"],
Cell[49078, 1298, 443, 7, 126, "Print", "ExpressionUUID" -> \
"fa8e37ca-da4c-459d-b471-9a3e9058131f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[49570, 1311, 155, 3, 62, "Section", "ExpressionUUID" -> \
"e4b942c9-2943-4194-b791-0a9d34585dd2"],
Cell[49728, 1316, 21801, 572, 2355, "Input", "ExpressionUUID" -> \
"a64f41bf-45e3-4440-9d11-f7dbd4a98788"],
Cell[71532, 1890, 1283, 21, 205, "Text", "ExpressionUUID" -> \
"44324ae8-b462-4891-9040-9ff3d30ac672"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72852, 1916, 274, 8, 81, "Section", "ExpressionUUID" -> \
"fae30207-e598-47de-bf1e-e4beb3a1288f"],
Cell[73129, 1926, 53011, 1605, 4551, "Input", "ExpressionUUID" -> \
"e2ece989-a252-4d4e-8093-8eb537b3f0d5"]
}, Closed]],
Cell[CellGroupData[{
Cell[126177, 3536, 176, 3, 62, "Section", "ExpressionUUID" -> \
"67a0b0f3-f9f1-4452-a252-1eb883391e95"],
Cell[126356, 3541, 44850, 1061, 4227, "Input", "ExpressionUUID" -> \
"c2a68c2c-9f49-420e-a674-b9395a5f2ddc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171243, 4607, 287, 5, 81, "Section", "ExpressionUUID" -> \
"0e020bf4-c4af-4ab4-884f-fe13e2382ae6"],
Cell[CellGroupData[{
Cell[171555, 4616, 4325, 113, 356, "Input", "ExpressionUUID" -> \
"b3e90460-60a9-404b-898a-30766fcc1adc"],
Cell[CellGroupData[{
Cell[175905, 4733, 500, 8, 30, "Print", "ExpressionUUID" -> \
"fc3ef0c9-7598-41c7-bc9d-8c61ccfc4e44"],
Cell[176408, 4743, 533, 9, 102, "Print", "ExpressionUUID" -> \
"0e81cfc2-ce79-4f53-ab4c-7f8e24c48999"],
Cell[176944, 4754, 628, 12, 30, "Print", "ExpressionUUID" -> \
"42e45f75-82e2-49ff-8ae0-353905c61f88"],
Cell[177575, 4768, 630, 12, 30, "Print", "ExpressionUUID" -> \
"5661dce3-12ef-4eeb-987e-40d01022ae14"],
Cell[178208, 4782, 683, 13, 30, "Print", "ExpressionUUID" -> \
"3a5141a2-a4bc-4e6e-aa0a-7dcab690b95c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[178940, 4801, 239, 6, 40, "Input", "ExpressionUUID" -> \
"7af6273a-dd36-46e8-aff1-5b0613164a54"],
Cell[179182, 4809, 737, 12, 40, "Output", "ExpressionUUID" -> \
"4fd0d70b-d85b-4ea1-8a26-f1b39ad200ae"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[179968, 4827, 160, 3, 62, "Section", "ExpressionUUID" -> \
"248f69a8-6be4-406b-81ff-0dcfe8171e14"],
Cell[180131, 4832, 1023, 31, 68, "Input", "ExpressionUUID" -> \
"92c253fa-c064-416a-843a-dcf7b8d363a2"],
Cell[CellGroupData[{
Cell[181179, 4867, 240, 6, 40, "Input", "ExpressionUUID" -> \
"ae84e743-d0e7-42c9-b79a-e8b6972cf6f2"],
Cell[181422, 4875, 706, 11, 87, "Output", "ExpressionUUID" -> \
"15b569f9-cd95-48dd-bfa0-839f3e567bd0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[182177, 4892, 302, 5, 62, "Section", "ExpressionUUID" -> \
"f25336d0-c510-435e-a55c-18fe9daf6b0c"],
Cell[CellGroupData[{
Cell[182504, 4901, 162, 3, 55, "Subsection", "ExpressionUUID" -> \
"b75c1901-fbfc-4f89-a9a5-2d772497deff"],
Cell[182669, 4906, 5290, 136, 330, "Input", "ExpressionUUID" -> \
"dad80baf-5f99-4b2c-bba7-086e01013931"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187996, 5047, 167, 3, 55, "Subsection", "ExpressionUUID" -> \
"b74ca7e1-efdb-4aa1-adbb-351e49e3ada2"],
Cell[188166, 5052, 9548, 276, 1012, "Input", "ExpressionUUID" -> \
"9e9b5c7c-2ca9-4188-9aca-04b2c928645e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197751, 5333, 176, 3, 56, "Subsection", "ExpressionUUID" -> \
"ee1b51f1-1236-4788-94c9-024a8ae3a903"],
Cell[197930, 5338, 2030, 65, 316, "Input", "ExpressionUUID" -> \
"9737130a-e12d-4377-be13-4b2326683b69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199997, 5408, 183, 3, 56, "Subsection", "ExpressionUUID" -> \
"6d3272a0-8d69-4cd3-9914-b5b1b67e4fc7"],
Cell[200183, 5413, 431, 14, 68, "Input", "ExpressionUUID" -> \
"303efbba-2f5a-46b0-9c4d-bd1a954fd6ad"],
Cell[CellGroupData[{
Cell[200639, 5431, 176, 3, 43, "Subsubsection", "ExpressionUUID" -> \
"2212f727-7192-4b31-9de1-aa501ccc5ef5"],
Cell[200818, 5436, 8123, 196, 233, "Input", "ExpressionUUID" -> \
"2e856dea-7944-4b24-b60b-0b93dbf37122"]
}, Closed]],
Cell[CellGroupData[{
Cell[208978, 5637, 2462, 34, 36, "Subsubsection", "ExpressionUUID" -> \
"2e856dea-7944-4b24-b60b-0b93dbf37122"],
Cell[211443, 5673, 15427, 378, 673, "Input", "ExpressionUUID" -> \
"2e856dea-7944-4b24-b60b-0b93dbf37122"]
}, Closed]],
Cell[CellGroupData[{
Cell[226907, 6056, 223, 4, 36, "Subsubsection", "ExpressionUUID" -> \
"664f795f-f0fe-4588-a093-fdeb83a87e0b"],
Cell[227133, 6062, 2578, 67, 96, "Input", "ExpressionUUID" -> \
"261675b4-c4c7-485a-bd89-71047af4f1d9"],
Cell[229714, 6131, 3978, 110, 123, "Input", "ExpressionUUID" -> \
"210c5719-d24b-4b2d-9777-1b3fb8a60efe"],
Cell[233695, 6243, 4927, 123, 151, "Input", "ExpressionUUID" -> \
"4969f42a-5510-4c07-82a6-e74817ea2f9f"]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[238683, 6373, 152, 3, 62, "Section", "ExpressionUUID" -> \
"c7706e92-2b2f-4b8f-adb7-56874a6727be"],
Cell[238838, 6378, 2074, 65, 146, "Input", "ExpressionUUID" -> \
"bea1cffb-a406-4b0a-bf7b-7210894eecac"],
Cell[CellGroupData[{
Cell[240937, 6447, 1104, 29, 146, "Input", "ExpressionUUID" -> \
"9013b48b-57ad-4077-8465-2e55a729a61b"],
Cell[242044, 6478, 193, 4, 40, "Output", "ExpressionUUID" -> \
"96ec41c0-ac2b-4ab6-881a-e3a487e90462"],
Cell[242240, 6484, 193, 4, 40, "Output", "ExpressionUUID" -> \
"cebc6aec-6781-41d1-b4c6-1ac084d3b51c"],
Cell[242436, 6490, 193, 4, 40, "Output", "ExpressionUUID" -> \
"008ee5ef-1bee-4953-8636-871fd2e7863c"],
Cell[242632, 6496, 193, 4, 40, "Output", "ExpressionUUID" -> \
"25041793-2e15-4fb3-926a-42d04233717a"],
Cell[242828, 6502, 197, 4, 40, "Output", "ExpressionUUID" -> \
"5ea0e017-3145-48e3-82ae-11eb1bb9f1c4"]
}, Open  ]],
Cell[243040, 6509, 2174, 66, 146, "Input", "ExpressionUUID" -> \
"b5c2f147-a7b1-4a60-bd81-677f7d195995"],
Cell[CellGroupData[{
Cell[245239, 6579, 1105, 29, 146, "Input", "ExpressionUUID" -> \
"f2e52a56-289a-4012-ab36-6ef58e0c5f99"],
Cell[246347, 6610, 193, 4, 40, "Output", "ExpressionUUID" -> \
"98b4e3cd-a537-4ed5-b789-f19487258b53"],
Cell[246543, 6616, 195, 4, 40, "Output", "ExpressionUUID" -> \
"ee3c1af1-2239-43d4-a54e-72af1f9eb43a"],
Cell[246741, 6622, 193, 4, 40, "Output", "ExpressionUUID" -> \
"96700c91-6d1e-4e3a-8d02-2246d8fc5fed"],
Cell[246937, 6628, 193, 4, 40, "Output", "ExpressionUUID" -> \
"76a510cb-703a-464f-a042-d880e767c2b1"],
Cell[247133, 6634, 195, 4, 40, "Output", "ExpressionUUID" -> \
"4f107ad4-a808-4971-982f-55a2907b81fe"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[247377, 6644, 159, 3, 62, "Section", "ExpressionUUID" -> \
"e768cc05-5418-4c64-8805-945bae3ed9c5"],
Cell[CellGroupData[{
Cell[247561, 6651, 166, 3, 54, "Subsection", "ExpressionUUID" -> \
"e2d59b8f-f17b-4396-9aae-19ccda969fdd"],
Cell[247730, 6656, 468, 10, 86, "Text", "ExpressionUUID" -> \
"9eb2d9ee-d05d-424b-b30b-85dbeadd346d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[248235, 6671, 159, 3, 54, "Subsection", "ExpressionUUID" -> \
"1d1ce248-89a2-4c32-be81-31eae1abbeca"],
Cell[248397, 6676, 1965, 47, 213, "Text", "ExpressionUUID" -> \
"6c10989b-8fd1-4bc2-870b-d3c895ff898a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250399, 6728, 163, 3, 54, "Subsection", "ExpressionUUID" -> \
"a47d550a-be46-4b04-bff4-ae447cc6c4db"],
Cell[250565, 6733, 242, 4, 38, "Text", "ExpressionUUID" -> \
"ca6ee763-3873-4df8-9c99-517620baee8c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

